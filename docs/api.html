
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>7. API Reference &#8212; Reflectorch Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="6. Advanced functionality" href="advanced_functionality.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/reflectorch_logo.png" class="logo__image only-light" alt="Reflectorch Documentation - Home"/>
    <script>document.write(`<img src="_static/reflectorch_logo.png" class="logo__image only-dark" alt="Reflectorch Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Reflectorch
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">1. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulations.html">2. Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_reflectorch.html">3. Using a trained reflectorch model</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_reflectorch_neutron.html">4. Neutron reflectometry use</a></li>
<li class="toctree-l1"><a class="reference internal" href="training_reflectorch.html">5. Training a reflectorch model</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_functionality.html">6. Advanced functionality</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">7. API Reference</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/schreiber-lab/reflectorch" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/api.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>API Reference</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params"><code class="docutils literal notranslate"><span class="pre">Params</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.reflectivity"><code class="docutils literal notranslate"><span class="pre">Params.reflectivity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.scale_with_q"><code class="docutils literal notranslate"><span class="pre">Params.scale_with_q()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.d_rhos"><code class="docutils literal notranslate"><span class="pre">Params.d_rhos</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.as_tensor"><code class="docutils literal notranslate"><span class="pre">Params.as_tensor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.from_tensor"><code class="docutils literal notranslate"><span class="pre">Params.from_tensor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.size2layers_num"><code class="docutils literal notranslate"><span class="pre">Params.size2layers_num()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.layers_num2size"><code class="docutils literal notranslate"><span class="pre">Params.layers_num2size()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.get_param_labels"><code class="docutils literal notranslate"><span class="pre">Params.get_param_labels()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler"><code class="docutils literal notranslate"><span class="pre">PriorSampler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler.PARAM_CLS"><code class="docutils literal notranslate"><span class="pre">PriorSampler.PARAM_CLS</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler.param_dim"><code class="docutils literal notranslate"><span class="pre">PriorSampler.param_dim</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler.max_num_layers"><code class="docutils literal notranslate"><span class="pre">PriorSampler.max_num_layers</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler.sample"><code class="docutils literal notranslate"><span class="pre">PriorSampler.sample()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler.scale_params"><code class="docutils literal notranslate"><span class="pre">PriorSampler.scale_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler.restore_params"><code class="docutils literal notranslate"><span class="pre">PriorSampler.restore_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicDataset"><code class="docutils literal notranslate"><span class="pre">BasicDataset</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicDataset.update_batch_data"><code class="docutils literal notranslate"><span class="pre">BasicDataset.update_batch_data()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicDataset.get_batch"><code class="docutils literal notranslate"><span class="pre">BasicDataset.get_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.QGenerator"><code class="docutils literal notranslate"><span class="pre">QGenerator</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstantQ"><code class="docutils literal notranslate"><span class="pre">ConstantQ</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstantQ.get_batch"><code class="docutils literal notranslate"><span class="pre">ConstantQ.get_batch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstantQ.scale_q"><code class="docutils literal notranslate"><span class="pre">ConstantQ.scale_q()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.VariableQ"><code class="docutils literal notranslate"><span class="pre">VariableQ</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.VariableQ.get_batch"><code class="docutils literal notranslate"><span class="pre">VariableQ.get_batch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.VariableQ.scale_q"><code class="docutils literal notranslate"><span class="pre">VariableQ.scale_q()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.QNoiseGenerator"><code class="docutils literal notranslate"><span class="pre">QNoiseGenerator</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.IntensityNoiseGenerator"><code class="docutils literal notranslate"><span class="pre">IntensityNoiseGenerator</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CurvesScaler"><code class="docutils literal notranslate"><span class="pre">CurvesScaler</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogAffineCurvesScaler"><code class="docutils literal notranslate"><span class="pre">LogAffineCurvesScaler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogAffineCurvesScaler.scale"><code class="docutils literal notranslate"><span class="pre">LogAffineCurvesScaler.scale()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogAffineCurvesScaler.restore"><code class="docutils literal notranslate"><span class="pre">LogAffineCurvesScaler.restore()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.MeanNormalizationCurvesScaler"><code class="docutils literal notranslate"><span class="pre">MeanNormalizationCurvesScaler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.MeanNormalizationCurvesScaler.scale"><code class="docutils literal notranslate"><span class="pre">MeanNormalizationCurvesScaler.scale()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.MeanNormalizationCurvesScaler.restore"><code class="docutils literal notranslate"><span class="pre">MeanNormalizationCurvesScaler.restore()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.MeanNormalizationCurvesScaler.save"><code class="docutils literal notranslate"><span class="pre">MeanNormalizationCurvesScaler.save()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.get_density_profiles"><code class="docutils literal notranslate"><span class="pre">get_density_profiles()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.reflectivity"><code class="docutils literal notranslate"><span class="pre">reflectivity()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Smearing"><code class="docutils literal notranslate"><span class="pre">Smearing</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Smearing.scale_resolutions"><code class="docutils literal notranslate"><span class="pre">Smearing.scale_resolutions()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogLikelihood"><code class="docutils literal notranslate"><span class="pre">LogLikelihood</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogLikelihood.calc_log_likelihood"><code class="docutils literal notranslate"><span class="pre">LogLikelihood.calc_log_likelihood()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogLikelihood.calc_log_posterior"><code class="docutils literal notranslate"><span class="pre">LogLikelihood.calc_log_posterior()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.GaussianExpIntensityNoise"><code class="docutils literal notranslate"><span class="pre">GaussianExpIntensityNoise</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.GaussianExpIntensityNoise.apply"><code class="docutils literal notranslate"><span class="pre">GaussianExpIntensityNoise.apply()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicQNoiseGenerator"><code class="docutils literal notranslate"><span class="pre">BasicQNoiseGenerator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicQNoiseGenerator.apply"><code class="docutils literal notranslate"><span class="pre">BasicQNoiseGenerator.apply()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstantAngle"><code class="docutils literal notranslate"><span class="pre">ConstantAngle</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstantAngle.get_batch"><code class="docutils literal notranslate"><span class="pre">ConstantAngle.get_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler.PARAM_CLS"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler.PARAM_CLS</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler.max_num_layers"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler.max_num_layers</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler.param_dim"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler.param_dim</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler.sample"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler.sample()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler.scale_params"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler.scale_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler.restore_params"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler.restore_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams"><code class="docutils literal notranslate"><span class="pre">BasicParams</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.get_param_labels"><code class="docutils literal notranslate"><span class="pre">BasicParams.get_param_labels()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.reflectivity"><code class="docutils literal notranslate"><span class="pre">BasicParams.reflectivity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.max_layer_num"><code class="docutils literal notranslate"><span class="pre">BasicParams.max_layer_num</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.num_params"><code class="docutils literal notranslate"><span class="pre">BasicParams.num_params</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.thicknesses"><code class="docutils literal notranslate"><span class="pre">BasicParams.thicknesses</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.roughnesses"><code class="docutils literal notranslate"><span class="pre">BasicParams.roughnesses</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.slds"><code class="docutils literal notranslate"><span class="pre">BasicParams.slds</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.real_slds"><code class="docutils literal notranslate"><span class="pre">BasicParams.real_slds</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.imag_slds"><code class="docutils literal notranslate"><span class="pre">BasicParams.imag_slds</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.as_tensor"><code class="docutils literal notranslate"><span class="pre">BasicParams.as_tensor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.from_tensor"><code class="docutils literal notranslate"><span class="pre">BasicParams.from_tensor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.scale_with_q"><code class="docutils literal notranslate"><span class="pre">BasicParams.scale_with_q()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel"><code class="docutils literal notranslate"><span class="pre">ParametricModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel.param_dim"><code class="docutils literal notranslate"><span class="pre">ParametricModel.param_dim</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel.sampler_strategy"><code class="docutils literal notranslate"><span class="pre">ParametricModel.sampler_strategy</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel.reflectivity"><code class="docutils literal notranslate"><span class="pre">ParametricModel.reflectivity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel.init_bounds"><code class="docutils literal notranslate"><span class="pre">ParametricModel.init_bounds()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel.get_param_labels"><code class="docutils literal notranslate"><span class="pre">ParametricModel.get_param_labels()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel.sample"><code class="docutils literal notranslate"><span class="pre">ParametricModel.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SamplerStrategy"><code class="docutils literal notranslate"><span class="pre">SamplerStrategy</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicSamplerStrategy"><code class="docutils literal notranslate"><span class="pre">BasicSamplerStrategy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicSamplerStrategy.sample"><code class="docutils literal notranslate"><span class="pre">BasicSamplerStrategy.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstrainedRoughnessSamplerStrategy"><code class="docutils literal notranslate"><span class="pre">ConstrainedRoughnessSamplerStrategy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstrainedRoughnessSamplerStrategy.sample"><code class="docutils literal notranslate"><span class="pre">ConstrainedRoughnessSamplerStrategy.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstrainedRoughnessAndImgSldSamplerStrategy"><code class="docutils literal notranslate"><span class="pre">ConstrainedRoughnessAndImgSldSamplerStrategy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstrainedRoughnessAndImgSldSamplerStrategy.sample"><code class="docutils literal notranslate"><span class="pre">ConstrainedRoughnessAndImgSldSamplerStrategy.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Trainer"><code class="docutils literal notranslate"><span class="pre">Trainer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Trainer.log"><code class="docutils literal notranslate"><span class="pre">Trainer.log()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Trainer.train"><code class="docutils literal notranslate"><span class="pre">Trainer.train()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Trainer.configure_optimizer"><code class="docutils literal notranslate"><span class="pre">Trainer.configure_optimizer()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Trainer.lr"><code class="docutils literal notranslate"><span class="pre">Trainer.lr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Trainer.set_lr"><code class="docutils literal notranslate"><span class="pre">Trainer.set_lr()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.TrainerCallback"><code class="docutils literal notranslate"><span class="pre">TrainerCallback</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.TrainerCallback.start_training"><code class="docutils literal notranslate"><span class="pre">TrainerCallback.start_training()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.TrainerCallback.end_training"><code class="docutils literal notranslate"><span class="pre">TrainerCallback.end_training()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.TrainerCallback.end_batch"><code class="docutils literal notranslate"><span class="pre">TrainerCallback.end_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PeriodicTrainerCallback"><code class="docutils literal notranslate"><span class="pre">PeriodicTrainerCallback</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PeriodicTrainerCallback.end_batch"><code class="docutils literal notranslate"><span class="pre">PeriodicTrainerCallback.end_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SaveBestModel"><code class="docutils literal notranslate"><span class="pre">SaveBestModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SaveBestModel.end_batch"><code class="docutils literal notranslate"><span class="pre">SaveBestModel.end_batch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SaveBestModel.save"><code class="docutils literal notranslate"><span class="pre">SaveBestModel.save()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogLosses"><code class="docutils literal notranslate"><span class="pre">LogLosses</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogLosses.end_batch"><code class="docutils literal notranslate"><span class="pre">LogLosses.end_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Logger"><code class="docutils literal notranslate"><span class="pre">Logger</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Loggers"><code class="docutils literal notranslate"><span class="pre">Loggers</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PrintLogger"><code class="docutils literal notranslate"><span class="pre">PrintLogger</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.TensorBoardLogger"><code class="docutils literal notranslate"><span class="pre">TensorBoardLogger</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.TensorBoardLogger.log"><code class="docutils literal notranslate"><span class="pre">TensorBoardLogger.log()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ScheduleBatchSize"><code class="docutils literal notranslate"><span class="pre">ScheduleBatchSize</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ScheduleLR"><code class="docutils literal notranslate"><span class="pre">ScheduleLR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ScheduleLR.start_training"><code class="docutils literal notranslate"><span class="pre">ScheduleLR.start_training()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ScheduleLR.end_batch"><code class="docutils literal notranslate"><span class="pre">ScheduleLR.end_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.StepLR"><code class="docutils literal notranslate"><span class="pre">StepLR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.StepLR.start_training"><code class="docutils literal notranslate"><span class="pre">StepLR.start_training()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CyclicLR"><code class="docutils literal notranslate"><span class="pre">CyclicLR</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogCyclicLR"><code class="docutils literal notranslate"><span class="pre">LogCyclicLR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogCyclicLR.end_batch"><code class="docutils literal notranslate"><span class="pre">LogCyclicLR.end_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ReduceLROnPlateau"><code class="docutils literal notranslate"><span class="pre">ReduceLROnPlateau</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ReduceLROnPlateau.end_batch"><code class="docutils literal notranslate"><span class="pre">ReduceLROnPlateau.end_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.OneCycleLR"><code class="docutils literal notranslate"><span class="pre">OneCycleLR</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CosineAnnealingWithWarmup"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingWithWarmup</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CosineAnnealingWithWarmup.get_lr"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingWithWarmup.get_lr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CosineAnnealingWithWarmup.start_training"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingWithWarmup.start_training()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CosineAnnealingWithWarmup.end_batch"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingWithWarmup.end_batch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CosineAnnealingWithWarmup.simulate_and_plot"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingWithWarmup.simulate_and_plot()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ReflectivityDataLoader"><code class="docutils literal notranslate"><span class="pre">ReflectivityDataLoader</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.RealTimeSimTrainer"><code class="docutils literal notranslate"><span class="pre">RealTimeSimTrainer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.RealTimeSimTrainer.get_batch_by_idx"><code class="docutils literal notranslate"><span class="pre">RealTimeSimTrainer.get_batch_by_idx()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.RealTimeSimTrainer.get_batch_by_size"><code class="docutils literal notranslate"><span class="pre">RealTimeSimTrainer.get_batch_by_size()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PointEstimatorTrainer"><code class="docutils literal notranslate"><span class="pre">PointEstimatorTrainer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PointEstimatorTrainer.get_loss_dict"><code class="docutils literal notranslate"><span class="pre">PointEstimatorTrainer.get_loss_dict()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConvEncoder"><code class="docutils literal notranslate"><span class="pre">ConvEncoder</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConvEncoder.forward"><code class="docutils literal notranslate"><span class="pre">ConvEncoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.FnoEncoder"><code class="docutils literal notranslate"><span class="pre">FnoEncoder</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.NetworkWithPriors"><code class="docutils literal notranslate"><span class="pre">NetworkWithPriors</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.NetworkWithPriors.forward"><code class="docutils literal notranslate"><span class="pre">NetworkWithPriors.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.NetworkWithPriorsConvEmb"><code class="docutils literal notranslate"><span class="pre">NetworkWithPriorsConvEmb</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.NetworkWithPriorsFnoEmb"><code class="docutils literal notranslate"><span class="pre">NetworkWithPriorsFnoEmb</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.to_np"><code class="docutils literal notranslate"><span class="pre">to_np()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.to_t"><code class="docutils literal notranslate"><span class="pre">to_t()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.train_from_config"><code class="docutils literal notranslate"><span class="pre">train_from_config()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.get_trainer_from_config"><code class="docutils literal notranslate"><span class="pre">get_trainer_from_config()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.get_paths_from_config"><code class="docutils literal notranslate"><span class="pre">get_paths_from_config()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.get_callbacks_from_config"><code class="docutils literal notranslate"><span class="pre">get_callbacks_from_config()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.get_trainer_by_name"><code class="docutils literal notranslate"><span class="pre">get_trainer_by_name()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.convert_pt_to_safetensors"><code class="docutils literal notranslate"><span class="pre">convert_pt_to_safetensors()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.load_config"><code class="docutils literal notranslate"><span class="pre">load_config()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.EasyInferenceModel"><code class="docutils literal notranslate"><span class="pre">EasyInferenceModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.EasyInferenceModel.load_model"><code class="docutils literal notranslate"><span class="pre">EasyInferenceModel.load_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.EasyInferenceModel.predict"><code class="docutils literal notranslate"><span class="pre">EasyInferenceModel.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.EasyInferenceModel.predict_using_widget"><code class="docutils literal notranslate"><span class="pre">EasyInferenceModel.predict_using_widget()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.HuggingfaceQueryMatcher"><code class="docutils literal notranslate"><span class="pre">HuggingfaceQueryMatcher</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.HuggingfaceQueryMatcher.get_matching_configs"><code class="docutils literal notranslate"><span class="pre">HuggingfaceQueryMatcher.get_matching_configs()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.standard_preprocessing"><code class="docutils literal notranslate"><span class="pre">standard_preprocessing()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.interp_reflectivity"><code class="docutils literal notranslate"><span class="pre">interp_reflectivity()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.apply_attenuation_correction"><code class="docutils literal notranslate"><span class="pre">apply_attenuation_correction()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.apply_footprint_correction"><code class="docutils literal notranslate"><span class="pre">apply_footprint_correction()</span></code></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-reflectorch">
<span id="api-reference"></span><h1><span class="section-number">7. </span>API Reference<a class="headerlink" href="#module-reflectorch" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.Params">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thicknesses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roughnesses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/params.html#Params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Params" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractParams</span></code></p>
<p>Parameter class for thickness, roughness and sld parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thicknesses</strong> (<em>Tensor</em>)  batch of thicknesses (top to bottom)</p></li>
<li><p><strong>roughnesses</strong> (<em>Tensor</em>)  batch of roughnesses (top to bottom)</p></li>
<li><p><strong>slds</strong> (<em>Tensor</em>)  batch of slds (top to bottom)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.Params.reflectivity">
<span class="sig-name descname"><span class="pre">reflectivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/params.html#Params.reflectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Params.reflectivity" title="Link to this definition">#</a></dt>
<dd><p>computes the reflectivity curves directly from the parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<em>Tensor</em>)  the q values</p></li>
<li><p><strong>log</strong> (<em>bool</em><em>, </em><em>optional</em>)  whether to apply logarithm to the curves. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the simulated reflectivity curves</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.Params.scale_with_q">
<span class="sig-name descname"><span class="pre">scale_with_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/params.html#Params.scale_with_q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Params.scale_with_q" title="Link to this definition">#</a></dt>
<dd><p>scales the parameters based on the q ratio</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q_ratio</strong> (<em>float</em>)  the scaling ratio</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.Params.d_rhos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">d_rhos</span></span><a class="headerlink" href="#reflectorch.Params.d_rhos" title="Link to this definition">#</a></dt>
<dd><p>computes the differences in SLD values of the neighboring layers</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.Params.as_tensor">
<span class="sig-name descname"><span class="pre">as_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_drho</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/params.html#Params.as_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Params.as_tensor" title="Link to this definition">#</a></dt>
<dd><p>converts the instance of the class to a Pytorch tensor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.Params.from_tensor">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/params.html#Params.from_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Params.from_tensor" title="Link to this definition">#</a></dt>
<dd><p>initializes an instance of the class from a Pytorch tensor containing the values of the parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.Params.size2layers_num">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">size2layers_num</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/params.html#Params.size2layers_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Params.size2layers_num" title="Link to this definition">#</a></dt>
<dd><p>converts the number of parameters to the number of layers</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.Params.layers_num2size">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">layers_num2size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/params.html#Params.layers_num2size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Params.layers_num2size" title="Link to this definition">#</a></dt>
<dd><p>converts the number of layers to the number of parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.Params.get_param_labels">
<span class="sig-name descname"><span class="pre">get_param_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/params.html#Params.get_param_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Params.get_param_labels" title="Link to this definition">#</a></dt>
<dd><p>gets the parameter labels, the layers are numbered from the bottom to the top
(i.e. opposite to the order in the Tensors)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.PriorSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PriorSampler</span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/base.html#PriorSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.PriorSampler" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for prior samplers</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reflectorch.PriorSampler.PARAM_CLS">
<span class="sig-name descname"><span class="pre">PARAM_CLS</span></span><a class="headerlink" href="#reflectorch.PriorSampler.PARAM_CLS" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#reflectorch.Params" title="reflectorch.data_generation.priors.params.Params"><code class="xref py py-class docutils literal notranslate"><span class="pre">Params</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.PriorSampler.param_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">param_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#reflectorch.PriorSampler.param_dim" title="Link to this definition">#</a></dt>
<dd><p>gets the number of parameters (i.e. the parameter dimensionality)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.PriorSampler.max_num_layers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_num_layers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#reflectorch.PriorSampler.max_num_layers" title="Link to this definition">#</a></dt>
<dd><p>gets the number of layers</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.PriorSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reflectorch.Params" title="reflectorch.data_generation.priors.params.Params"><span class="pre">Params</span></a></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/base.html#PriorSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.PriorSampler.sample" title="Link to this definition">#</a></dt>
<dd><p>sample a batch of parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.PriorSampler.scale_params">
<span class="sig-name descname"><span class="pre">scale_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Params" title="reflectorch.data_generation.priors.params.Params"><span class="pre">Params</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/base.html#PriorSampler.scale_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.PriorSampler.scale_params" title="Link to this definition">#</a></dt>
<dd><p>scale the parameters to a ML-friendly range</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.PriorSampler.restore_params">
<span class="sig-name descname"><span class="pre">restore_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scaled_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reflectorch.Params" title="reflectorch.data_generation.priors.params.Params"><span class="pre">Params</span></a></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/base.html#PriorSampler.restore_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.PriorSampler.restore_params" title="Link to this definition">#</a></dt>
<dd><p>restore the parameters to their original range</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.BasicDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BasicDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.QGenerator" title="reflectorch.data_generation.q_generator.QGenerator"><span class="pre">QGenerator</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.PriorSampler" title="reflectorch.data_generation.priors.base.PriorSampler"><span class="pre">PriorSampler</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity_noise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.IntensityNoiseGenerator" title="reflectorch.data_generation.noise.IntensityNoiseGenerator"><span class="pre">IntensityNoiseGenerator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_noise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.QNoiseGenerator" title="reflectorch.data_generation.noise.QNoiseGenerator"><span class="pre">QNoiseGenerator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curves_scaler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.CurvesScaler" title="reflectorch.data_generation.scale_curves.CurvesScaler"><span class="pre">CurvesScaler</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_denoised_curves</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_nonsmeared_curves</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smearing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Smearing" title="reflectorch.data_generation.smearing.Smearing"><span class="pre">Smearing</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/dataset.html#BasicDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.BasicDataset" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Reflectometry dataset. It generates the q positions, samples the thin film parameters from the prior,
simulates the reflectivity curves and applies noise to the curves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_generator</strong> (<a class="reference internal" href="#reflectorch.QGenerator" title="reflectorch.QGenerator"><em>QGenerator</em></a>)  the momentum transfer (q) generator</p></li>
<li><p><strong>prior_sampler</strong> (<a class="reference internal" href="#reflectorch.PriorSampler" title="reflectorch.PriorSampler"><em>PriorSampler</em></a>)  the prior sampler</p></li>
<li><p><strong>intensity_noise</strong> (<a class="reference internal" href="#reflectorch.IntensityNoiseGenerator" title="reflectorch.IntensityNoiseGenerator"><em>IntensityNoiseGenerator</em></a><em>, </em><em>optional</em>)  the intensity noise generator. Defaults to None.</p></li>
<li><p><strong>q_noise</strong> (<a class="reference internal" href="#reflectorch.QNoiseGenerator" title="reflectorch.QNoiseGenerator"><em>QNoiseGenerator</em></a><em>, </em><em>optional</em>)  the q noise generator. Defaults to None.</p></li>
<li><p><strong>curves_scaler</strong> (<a class="reference internal" href="#reflectorch.CurvesScaler" title="reflectorch.CurvesScaler"><em>CurvesScaler</em></a><em>, </em><em>optional</em>)  the reflectivity curve scaler. Defaults to an instance of LogAffineCurvesScaler,
which scales the curves to the range [-1, 1], the minimum considered intensity being 1e-10.</p></li>
<li><p><strong>calc_denoised_curves</strong> (<em>bool</em><em>, </em><em>optional</em>)  whether to add the curves without noise to the dictionary. Defaults to False.</p></li>
<li><p><strong>calc_nonsmeared_curves</strong> (<em>bool</em><em>, </em><em>optional</em>)  whether to add the curves without smearing to the dictionary (only relevant when smearing is applied). Defaults to False.</p></li>
<li><p><strong>smearing</strong> (<a class="reference internal" href="#reflectorch.Smearing" title="reflectorch.Smearing"><em>Smearing</em></a><em>, </em><em>optional</em>)  curve smearing generator. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.BasicDataset.update_batch_data">
<span class="sig-name descname"><span class="pre">update_batch_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#reflectorch.BasicParams" title="reflectorch.data_generation.priors.parametric_subpriors.BasicParams"><span class="pre">BasicParams</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/dataset.html#BasicDataset.update_batch_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.BasicDataset.update_batch_data" title="Link to this definition">#</a></dt>
<dd><p>implement in a subclass to edit batch_data dict inplace</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.BasicDataset.get_batch">
<span class="sig-name descname"><span class="pre">get_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#reflectorch.BasicParams" title="reflectorch.data_generation.priors.parametric_subpriors.BasicParams"><span class="pre">BasicParams</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/dataset.html#BasicDataset.get_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.BasicDataset.get_batch" title="Link to this definition">#</a></dt>
<dd><p>get a batch of data as a dictionary with keys <code class="docutils literal notranslate"><span class="pre">params</span></code>, <code class="docutils literal notranslate"><span class="pre">scaled_params</span></code>, <code class="docutils literal notranslate"><span class="pre">q_values</span></code>, <code class="docutils literal notranslate"><span class="pre">curves</span></code>, <code class="docutils literal notranslate"><span class="pre">scaled_noisy_curves</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>int</em>)  the batch size</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.QGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QGenerator</span></span><a class="reference internal" href="_modules/reflectorch/data_generation/q_generator.html#QGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.QGenerator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for momentum transfer (q) generators</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.ConstantQ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConstantQ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.2,</span> <span class="pre">128)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_zero</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_zero</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/q_generator.html#ConstantQ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ConstantQ" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.QGenerator" title="reflectorch.data_generation.q_generator.QGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">QGenerator</span></code></a></p>
<p>Q generator for reflectivity curves with fixed discretization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<em>Union</em><em>[</em><em>Tensor</em><em>, </em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>)  tuple (q_min, q_max, num_q) defining the minimum q value, maximum q value and the number of q points. Defaults to (0., 0.2, 128).</p></li>
<li><p><strong>device</strong> (<em>optional</em>)  the Pytorch device. Defaults to DEFAULT_DEVICE.</p></li>
<li><p><strong>dtype</strong> (<em>optional</em>)  the Pytorch data type. Defaults to DEFAULT_DTYPE.</p></li>
<li><p><strong>remove_zero</strong> (<em>bool</em><em>, </em><em>optional</em>)  do not include the upper end of the interval. Defaults to False.</p></li>
<li><p><strong>fixed_zero</strong> (<em>bool</em><em>, </em><em>optional</em>)  do not include the lower end of the interval. Defaults to False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.ConstantQ.get_batch">
<span class="sig-name descname"><span class="pre">get_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/q_generator.html#ConstantQ.get_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ConstantQ.get_batch" title="Link to this definition">#</a></dt>
<dd><p>generate a batch of q values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>int</em>)  the batch size</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>generated batch of q values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.ConstantQ.scale_q">
<span class="sig-name descname"><span class="pre">scale_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/q_generator.html#ConstantQ.scale_q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ConstantQ.scale_q" title="Link to this definition">#</a></dt>
<dd><p>Scales the q values to the range [-1, 1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q</strong> (<em>Tensor</em>)  unscaled q values</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>scaled q values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.VariableQ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">VariableQ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_min_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.01,</span> <span class="pre">0.03)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_max_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.1,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_q_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(64,</span> <span class="pre">256)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'equidistant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/q_generator.html#VariableQ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.VariableQ" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.QGenerator" title="reflectorch.data_generation.q_generator.QGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">QGenerator</span></code></a></p>
<p>Q generator for reflectivity curves with variable discretization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_min_range</strong> (<em>list</em><em>, </em><em>optional</em>)  the range for sampling the minimum q value of the curves, q_min. Defaults to [0.01, 0.03].</p></li>
<li><p><strong>q_max_range</strong> (<em>list</em><em>, </em><em>optional</em>)  the range for sampling the maximum q value of the curves, q_max. Defaults to [0.1, 0.5].</p></li>
<li><p><strong>n_q_range</strong> (<em>list</em><em>, </em><em>optional</em>)  the range for the number of points in the curves (equidistantly sampled between q_min and q_max,
the number of points varies between batches but is constant within a batch). Defaults to [64, 256].</p></li>
<li><p><strong>device</strong> (<em>optional</em>)  the Pytorch device. Defaults to DEFAULT_DEVICE.</p></li>
<li><p><strong>dtype</strong> (<em>optional</em>)  the Pytorch data type. Defaults to DEFAULT_DTYPE.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.VariableQ.get_batch">
<span class="sig-name descname"><span class="pre">get_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/q_generator.html#VariableQ.get_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.VariableQ.get_batch" title="Link to this definition">#</a></dt>
<dd><p>generate a batch of q values (the number of points varies between batches but is constant within a batch)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>int</em>)  the batch size</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>generated batch of q values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.VariableQ.scale_q">
<span class="sig-name descname"><span class="pre">scale_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/q_generator.html#VariableQ.scale_q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.VariableQ.scale_q" title="Link to this definition">#</a></dt>
<dd><p>scales the q values to the range [-1, 1]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q</strong> (<em>Tensor</em>)  unscaled q values</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>scaled q values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.QNoiseGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QNoiseGenerator</span></span><a class="reference internal" href="_modules/reflectorch/data_generation/noise.html#QNoiseGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.QNoiseGenerator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ProcessData</span></code></p>
<p>Base class for q noise generators</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.IntensityNoiseGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IntensityNoiseGenerator</span></span><a class="reference internal" href="_modules/reflectorch/data_generation/noise.html#IntensityNoiseGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.IntensityNoiseGenerator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ProcessData</span></code></p>
<p>Base class for intensity noise generators</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.CurvesScaler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CurvesScaler</span></span><a class="reference internal" href="_modules/reflectorch/data_generation/scale_curves.html#CurvesScaler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.CurvesScaler" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for curve scalers</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.LogAffineCurvesScaler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LogAffineCurvesScaler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/scale_curves.html#LogAffineCurvesScaler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.LogAffineCurvesScaler" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.CurvesScaler" title="reflectorch.data_generation.scale_curves.CurvesScaler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CurvesScaler</span></code></a></p>
<p>Curve scaler which scales the reflectivity curves according to the logarithmic affine transformation:
<span class="math notranslate nohighlight">\(\log_{10}(R + eps) \cdot weight + bias\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weight</strong> (<em>float</em>)  multiplication factor in the transformation</p></li>
<li><p><strong>bias</strong> (<em>float</em>)  addition term in the transformation</p></li>
<li><p><strong>eps</strong> (<em>float</em>)  sets the minimum intensity value of the reflectivity curves which is considered</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.LogAffineCurvesScaler.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curves</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/scale_curves.html#LogAffineCurvesScaler.scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.LogAffineCurvesScaler.scale" title="Link to this definition">#</a></dt>
<dd><p>scales the reflectivity curves to a ML-friendly range</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>curves</strong> (<em>Tensor</em>)  original reflectivity curves</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>reflectivity curves scaled to a ML-friendly range</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.LogAffineCurvesScaler.restore">
<span class="sig-name descname"><span class="pre">restore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curves</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/scale_curves.html#LogAffineCurvesScaler.restore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.LogAffineCurvesScaler.restore" title="Link to this definition">#</a></dt>
<dd><p>restores the physical reflectivity curves</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>curves</strong> (<em>Tensor</em>)  scaled reflectivity curves</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>reflectivity curves restored to the physical range</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.MeanNormalizationCurvesScaler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MeanNormalizationCurvesScaler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curves_mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/scale_curves.html#MeanNormalizationCurvesScaler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.MeanNormalizationCurvesScaler" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.CurvesScaler" title="reflectorch.data_generation.scale_curves.CurvesScaler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CurvesScaler</span></code></a></p>
<p>Curve scaler which scales the reflectivity curves by the precomputed mean of a batch of curves</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em>)  path to the precomputed mean of the curves, only used if <code class="docutils literal notranslate"><span class="pre">curves_mean</span></code> is None. Defaults to None.</p></li>
<li><p><strong>curves_mean</strong> (<em>Tensor</em><em>, </em><em>optional</em>)  the precomputed mean of the curves. Defaults to None.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>)  the Pytorch device. Defaults to cuda.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.MeanNormalizationCurvesScaler.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curves</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/scale_curves.html#MeanNormalizationCurvesScaler.scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.MeanNormalizationCurvesScaler.scale" title="Link to this definition">#</a></dt>
<dd><p>scales the reflectivity curves to a ML-friendly range</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>curves</strong> (<em>Tensor</em>)  original reflectivity curves</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>reflectivity curves scaled to a ML-friendly range</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.MeanNormalizationCurvesScaler.restore">
<span class="sig-name descname"><span class="pre">restore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curves</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/scale_curves.html#MeanNormalizationCurvesScaler.restore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.MeanNormalizationCurvesScaler.restore" title="Link to this definition">#</a></dt>
<dd><p>restores the physical reflectivity curves</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>curves</strong> (<em>Tensor</em>)  scaled reflectivity curves</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>reflectivity curves restored to the physical range</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.MeanNormalizationCurvesScaler.save">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prior_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.PriorSampler" title="reflectorch.data_generation.priors.base.PriorSampler"><span class="pre">PriorSampler</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16384</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/scale_curves.html#MeanNormalizationCurvesScaler.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.MeanNormalizationCurvesScaler.save" title="Link to this definition">#</a></dt>
<dd><p>computes the mean of a batch of reflectivity curves and saves it</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prior_sampler</strong> (<a class="reference internal" href="#reflectorch.PriorSampler" title="reflectorch.PriorSampler"><em>PriorSampler</em></a>)  the prior sampler</p></li>
<li><p><strong>q</strong> (<em>Tensor</em>)  the q values</p></li>
<li><p><strong>path</strong> (<em>str</em>)  the path for saving the mean of the curves</p></li>
<li><p><strong>num</strong> (<em>int</em><em>, </em><em>optional</em>)  the number of curves used to compute the mean. Defaults to 16384.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.get_density_profiles">
<span class="sig-name descname"><span class="pre">get_density_profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thicknesses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roughnesses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ambient_sld</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_left</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_right</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/utils.html#get_density_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.get_density_profiles" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thicknesses</strong> (<em>Tensor</em>)  finite layer thicknesses.</p></li>
<li><p><strong>roughnesses</strong> (<em>Tensor</em>)  interface roughnesses for all transitions (ambientlayer1  layerNsubstrate).</p></li>
<li><p><strong>slds</strong> (<em>Tensor</em>)  SLDs for the finite layers + substrate.</p></li>
<li><p><strong>ambient_sld</strong> (<em>Tensor</em><em>, </em><em>optional</em>)  SLD for the top ambient. Defaults to 0.0 if None.</p></li>
<li><p><strong>z_axis</strong> (<em>Tensor</em><em>, </em><em>optional</em>)  a custom depth axis. If None, a linear axis is generated.</p></li>
<li><p><strong>num</strong> (<em>int</em>)  number of points in the generated z-axis (if z_axis is None).</p></li>
<li><p><strong>padding_left</strong> (<em>float</em>)  factor to extend the negative (above the surface) portion of z-axis.</p></li>
<li><p><strong>padding_right</strong> (<em>float</em>)  factor to extend the positive (into the sample) portion of z-axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(z_axis, profile, d_profile)</dt><dd><p>z_axis:    1D Tensor of shape (num, ) with the depth coordinates.
profile:   2D Tensor of shape (batch_size, num) giving the SLD at each depth.
d_profile: 2D Tensor of shape (batch_size, num) giving d(SLD)/dz at each depth.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.reflectivity">
<span class="sig-name descname"><span class="pre">reflectivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roughness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sld</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gauss_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">51</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_dq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solvent_vf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solvent_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fronting'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abeles_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">abeles_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/reflectivity.html#reflectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.reflectivity" title="Link to this definition">#</a></dt>
<dd><p>Function which computes the reflectivity curves from thin film parameters.
By default it uses the fast implementation of the Abeles matrix formalism.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<em>Tensor</em>)  tensor of momentum transfer (q) values with shape [batch_size, n_points] or [n_points]</p></li>
<li><p><strong>thickness</strong> (<em>Tensor</em>)  tensor containing the layer thicknesses (ordered from top to bottom) with shape [batch_size, n_layers]</p></li>
<li><p><strong>roughness</strong> (<em>Tensor</em>)  tensor containing the interlayer roughnesses (ordered from top to bottom) with shape [batch_size, n_layers + 1]</p></li>
<li><p><strong>sld</strong> (<em>Tensor</em>)  tensor containing the layer SLDs (real or complex; ordered from top to bottom) with shape
[batch_size, n_layers + 1] (excluding ambient SLD which is assumed to be 0)  or [batch_size, n_layers + 2] (including ambient SLD; only for the default <code class="docutils literal notranslate"><span class="pre">abeles_func='abeles'</span></code>)</p></li>
<li><p><strong>dq</strong> (<em>Tensor</em><em>, </em><em>optional</em>)  tensor of resolutions used for curve smearing with shape [batch_size, 1].
Either dq if <code class="docutils literal notranslate"><span class="pre">constant_dq</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or dq/q if <code class="docutils literal notranslate"><span class="pre">constant_dq</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>. Defaults to None.</p></li>
<li><p><strong>gauss_num</strong> (<em>int</em><em>, </em><em>optional</em>)  the number of gaussians for curve smearing. Defaults to 51.</p></li>
<li><p><strong>constant_dq</strong> (<em>bool</em><em>, </em><em>optional</em>)  if <code class="docutils literal notranslate"><span class="pre">True</span></code> the smearing is constant (constant dq at each point in the curve)
otherwise the smearing is linear (constant dq/q at each point in the curve). Defaults to False.</p></li>
<li><p><strong>log</strong> (<em>bool</em><em>, </em><em>optional</em>)  if True the base 10 logarithm of the reflectivity curves is returned. Defaults to False.</p></li>
<li><p><strong>q_shift</strong> (<em>float</em><em> or </em><em>Tensor</em><em>, </em><em>optional</em>)  misalignment in q.</p></li>
<li><p><strong>r_scale</strong> (<em>float</em><em> or </em><em>Tensor</em><em>, </em><em>optional</em>)  normalization factor (scales reflectivity).</p></li>
<li><p><strong>background</strong> (<em>float</em><em> or </em><em>Tensor</em><em>, </em><em>optional</em>)  background intensity.</p></li>
<li><p><strong>abeles_func</strong> (<em>Callable</em><em>, </em><em>optional</em>)  a function implementing the simulation of the reflectivity curves, if different than the default Abeles matrix implementation (abeles). Defaults to None.</p></li>
<li><p><strong>abeles_kwargs</strong>  Additional arguments specific to the chosen <cite>abeles_func</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the computed reflectivity curves</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.Smearing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Smearing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.01,</span> <span class="pre">0.1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_dq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gauss_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">31</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">share_smeared</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/smearing.html#Smearing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Smearing" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class which applies resolution smearing to the reflectivity curves.
The intensity at a q point will be the average of the intensities of neighbouring q points, weighted by a gaussian profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma_range</strong> (<em>tuple</em><em>, </em><em>optional</em>)  the range for sampling the resolutions. Defaults to (0.01, 0.1).</p></li>
<li><p><strong>constant_dq</strong> (<em>bool</em><em>, </em><em>optional</em>)  if <code class="docutils literal notranslate"><span class="pre">True</span></code> the smearing is constant (the resolution is given by the constant dq at each point in the curve)
otherwise the smearing is linear (the resolution is given by the constant dq/q at each point in the curve). Defaults to True.</p></li>
<li><p><strong>gauss_num</strong> (<em>int</em><em>, </em><em>optional</em>)  the number of interpolating gaussian profiles. Defaults to 31.</p></li>
<li><p><strong>share_smeared</strong> (<em>float</em><em>, </em><em>optional</em>)  the share of curves in the batch for which the resolution smearing is applied. Defaults to 0.2.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.Smearing.scale_resolutions">
<span class="sig-name descname"><span class="pre">scale_resolutions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resolutions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/smearing.html#Smearing.scale_resolutions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Smearing.scale_resolutions" title="Link to this definition">#</a></dt>
<dd><p>Scales the q-resolution values to [-1,1] range using the internal sigma range</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.LogLikelihood">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LogLikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_curve</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.PriorSampler" title="reflectorch.data_generation.priors.base.PriorSampler"><span class="pre">PriorSampler</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/likelihoods.html#LogLikelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.LogLikelihood" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Computes the gaussian log likelihood of the thin film parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<em>Tensor</em>)  the q values</p></li>
<li><p><strong>exp_curve</strong> (<em>Tensor</em>)  the experimental reflectivity curve</p></li>
<li><p><strong>priors</strong> (<a class="reference internal" href="#reflectorch.PriorSampler" title="reflectorch.PriorSampler"><em>PriorSampler</em></a>)  the prior sampler</p></li>
<li><p><strong>sigmas</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>Tensor</em><em>]</em>)  the sigmas (i.e. intensity error bars)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.LogLikelihood.calc_log_likelihood">
<span class="sig-name descname"><span class="pre">calc_log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curves</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/likelihoods.html#LogLikelihood.calc_log_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.LogLikelihood.calc_log_likelihood" title="Link to this definition">#</a></dt>
<dd><p>computes the gaussian log likelihood</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.LogLikelihood.calc_log_posterior">
<span class="sig-name descname"><span class="pre">calc_log_posterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Params" title="reflectorch.data_generation.priors.params.Params"><span class="pre">Params</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curves</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reflectorch.LogLikelihood.calc_log_posterior" title="Link to this definition">#</a></dt>
<dd><p>Call self as a function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.GaussianExpIntensityNoise">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GaussianExpIntensityNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relative_errors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.001,</span> <span class="pre">0.15)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consistent_rel_err</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-0.1,</span> <span class="pre">0.002)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_background</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(1e-10,</span> <span class="pre">1e-08)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">same_background_across_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_to_context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/noise.html#GaussianExpIntensityNoise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.GaussianExpIntensityNoise" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.IntensityNoiseGenerator" title="reflectorch.data_generation.noise.IntensityNoiseGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntensityNoiseGenerator</span></code></a></p>
<p>A composite noise generator that applies Gaussian, shift and background noise to reflectivity curves.</p>
<p>This class combines three types of noise:
1. Gaussian noise: Applies Gaussian noise (to account for count-based Poisson noise as well as other sources of error)
2. Shift noise: Applies a multiplicative shift to the curves, equivalent to a vertical shift in logarithmic space.
3. Background noise: Adds a constant background value to the curves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>relative_errors</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>, </em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em><em>]</em>)  The range of relative errors for Gaussian noise. Defaults to (0.001, 0.15).</p></li>
<li><p><strong>consistent_rel_err</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, uses a consistent relative error for Gaussian noise across all points in a curve. Defaults to False.</p></li>
<li><p><strong>shift_range</strong> (<em>tuple</em><em>, </em><em>optional</em>)  The range of shift factors for shift noise. Defaults to (-0.1, 0.2e-2).</p></li>
<li><p><strong>background_range</strong> (<em>tuple</em><em>, </em><em>optional</em>)  The range from which the background value is sampled. Defaults to (1.0e-10, 1.0e-8).</p></li>
<li><p><strong>apply_shift</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, applies shift noise to the curves. Defaults to False.</p></li>
<li><p><strong>apply_background</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, applies background noise to the curves. Defaults to False.</p></li>
<li><p><strong>same_background_across_channels</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, the same background is applied to all channels of a multi-channel curve. Defaults to False.</p></li>
<li><p><strong>add_to_context</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, adds generated noise parameters to the context dictionary. Defaults to False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.GaussianExpIntensityNoise.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curves</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/noise.html#GaussianExpIntensityNoise.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.GaussianExpIntensityNoise.apply" title="Link to this definition">#</a></dt>
<dd><p>applies the specified types of noise to the input curves</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.BasicQNoiseGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BasicQNoiseGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apply_systematic_shifts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_gaussian_noise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0.001)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_to_context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/noise.html#BasicQNoiseGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.BasicQNoiseGenerator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.QNoiseGenerator" title="reflectorch.data_generation.noise.QNoiseGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">QNoiseGenerator</span></code></a></p>
<p>Q noise generator which applies both systematic shifts (same change for all q points in the curve) and random noise (different changes per q point in the curve)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shift_std</strong> (<em>float</em><em>, </em><em>optional</em>)  the standard deviation of the normal distribution for systematic q shifts
(i.e. same change applied to all q points in the curve). Defaults to 1e-3.</p></li>
<li><p><strong>noise_std</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>)  the standard deviation of the normal distribution for random q noise
(i.e. different changes applied to each q point in the curve). The standard deviation is the same
for all curves in the batch if provided as a float, or uniformly sampled for each curve in the batch if provided as a tuple.
Defaults to (0, 1e-3).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.BasicQNoiseGenerator.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/noise.html#BasicQNoiseGenerator.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.BasicQNoiseGenerator.apply" title="Link to this definition">#</a></dt>
<dd><p>applies noise to the q values</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.ConstantAngle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConstantAngle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.2,</span> <span class="pre">257)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/q_generator.html#ConstantAngle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ConstantAngle" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.QGenerator" title="reflectorch.data_generation.q_generator.QGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">QGenerator</span></code></a></p>
<p>Q generator for reflectivity curves measured at equidistant angles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angle_range</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>)  the range of the incident angles. Defaults to (0., 0.2, 257).</p></li>
<li><p><strong>wavelength</strong> (<em>float</em><em>, </em><em>optional</em>)  the beam wavelength in units of angstroms. Defaults to 1.</p></li>
<li><p><strong>device</strong> (<em>optional</em>)  the Pytorch device. Defaults to DEFAULT_DEVICE.</p></li>
<li><p><strong>dtype</strong> (<em>optional</em>)  the Pytorch data type. Defaults to DEFAULT_DTYPE.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.ConstantAngle.get_batch">
<span class="sig-name descname"><span class="pre">get_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/q_generator.html#ConstantAngle.get_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ConstantAngle.get_batch" title="Link to this definition">#</a></dt>
<dd><p>generate a batch of q values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>int</em>)  the batch size</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>generated batch of q values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.SubpriorParametricSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SubpriorParametricSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_ranges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound_width_ranges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logdist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_params_by_ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaled_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-1.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_subpriors.html#SubpriorParametricSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.SubpriorParametricSampler" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.PriorSampler" title="reflectorch.data_generation.priors.base.PriorSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">PriorSampler</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ScalerMixin</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reflectorch.SubpriorParametricSampler.PARAM_CLS">
<span class="sig-name descname"><span class="pre">PARAM_CLS</span></span><a class="headerlink" href="#reflectorch.SubpriorParametricSampler.PARAM_CLS" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#reflectorch.BasicParams" title="reflectorch.data_generation.priors.parametric_subpriors.BasicParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasicParams</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.SubpriorParametricSampler.max_num_layers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_num_layers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#reflectorch.SubpriorParametricSampler.max_num_layers" title="Link to this definition">#</a></dt>
<dd><p>gets the maximum number of layers</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.SubpriorParametricSampler.param_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">param_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#reflectorch.SubpriorParametricSampler.param_dim" title="Link to this definition">#</a></dt>
<dd><p>get the number of parameters (parameter dimensionality)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.SubpriorParametricSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reflectorch.BasicParams" title="reflectorch.data_generation.priors.parametric_subpriors.BasicParams"><span class="pre">BasicParams</span></a></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_subpriors.html#SubpriorParametricSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.SubpriorParametricSampler.sample" title="Link to this definition">#</a></dt>
<dd><p>sample a batch of parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>int</em>)  the batch size</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>sampled parameters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#reflectorch.BasicParams" title="reflectorch.BasicParams">BasicParams</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.SubpriorParametricSampler.scale_params">
<span class="sig-name descname"><span class="pre">scale_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.BasicParams" title="reflectorch.data_generation.priors.parametric_subpriors.BasicParams"><span class="pre">BasicParams</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_subpriors.html#SubpriorParametricSampler.scale_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.SubpriorParametricSampler.scale_params" title="Link to this definition">#</a></dt>
<dd><p>scale the parameters to a ML-friendly range</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#reflectorch.BasicParams" title="reflectorch.BasicParams"><em>BasicParams</em></a>)  the parameters to be scaled</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the scaled parameters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.SubpriorParametricSampler.restore_params">
<span class="sig-name descname"><span class="pre">restore_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scaled_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reflectorch.BasicParams" title="reflectorch.data_generation.priors.parametric_subpriors.BasicParams"><span class="pre">BasicParams</span></a></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_subpriors.html#SubpriorParametricSampler.restore_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.SubpriorParametricSampler.restore_params" title="Link to this definition">#</a></dt>
<dd><p>restore the parameters to their original range</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scaled_params</strong> (<em>Tensor</em>)  the scaled parameters</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the parameters restored to their original range</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#reflectorch.BasicParams" title="reflectorch.BasicParams">BasicParams</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.BasicParams">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BasicParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.ParametricModel" title="reflectorch.data_generation.priors.parametric_models.ParametricModel"><span class="pre">ParametricModel</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_subpriors.html#BasicParams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.BasicParams" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractParams</span></code></p>
<p>Parameter class compatible with different parameterizations of the SLD profile. It stores the parameters as well as their minimum and maximum subprior bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>Tensor</em>)  the values of the thin film parameters</p></li>
<li><p><strong>min_bounds</strong> (<em>Tensor</em>)  the minimum subprior bounds of the parameters</p></li>
<li><p><strong>max_bounds</strong> (<em>Tensor</em>)  the maximum subprior bounds of the parameters</p></li>
<li><p><strong>max_num_layers</strong> (<em>int</em><em>, </em><em>optional</em>)  the maximum number of layers (for box model parameterizations it is the number of layers). Defaults to None.</p></li>
<li><p><strong>param_model</strong> (<a class="reference internal" href="#reflectorch.ParametricModel" title="reflectorch.ParametricModel"><em>ParametricModel</em></a><em>, </em><em>optional</em>)  the parametric model. Defaults to the box model parameterization with number of layers given by max_num_layers.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.BasicParams.get_param_labels">
<span class="sig-name descname"><span class="pre">get_param_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_subpriors.html#BasicParams.get_param_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.BasicParams.get_param_labels" title="Link to this definition">#</a></dt>
<dd><p>gets the parameter labels</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.BasicParams.reflectivity">
<span class="sig-name descname"><span class="pre">reflectivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_subpriors.html#BasicParams.reflectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.BasicParams.reflectivity" title="Link to this definition">#</a></dt>
<dd><p>computes the reflectivity curves directly from the parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<em>Tensor</em>)  the q values</p></li>
<li><p><strong>log</strong> (<em>bool</em><em>, </em><em>optional</em>)  whether to apply logarithm to the curves. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the simulated reflectivity curves</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.BasicParams.max_layer_num">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_layer_num</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#reflectorch.BasicParams.max_layer_num" title="Link to this definition">#</a></dt>
<dd><p>gets the maximum number of layers</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.BasicParams.num_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#reflectorch.BasicParams.num_params" title="Link to this definition">#</a></dt>
<dd><p>get the number of parameters (parameter dimensionality)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.BasicParams.thicknesses">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">thicknesses</span></span><a class="headerlink" href="#reflectorch.BasicParams.thicknesses" title="Link to this definition">#</a></dt>
<dd><p>gets the thicknesses</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.BasicParams.roughnesses">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">roughnesses</span></span><a class="headerlink" href="#reflectorch.BasicParams.roughnesses" title="Link to this definition">#</a></dt>
<dd><p>gets the roughnesses</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.BasicParams.slds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">slds</span></span><a class="headerlink" href="#reflectorch.BasicParams.slds" title="Link to this definition">#</a></dt>
<dd><p>gets the slds</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.BasicParams.real_slds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">real_slds</span></span><a class="headerlink" href="#reflectorch.BasicParams.real_slds" title="Link to this definition">#</a></dt>
<dd><p>gets the real part of the slds</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.BasicParams.imag_slds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">imag_slds</span></span><a class="headerlink" href="#reflectorch.BasicParams.imag_slds" title="Link to this definition">#</a></dt>
<dd><p>gets the imaginary part of the slds (only for complex dtypes)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.BasicParams.as_tensor">
<span class="sig-name descname"><span class="pre">as_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_subpriors.html#BasicParams.as_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.BasicParams.as_tensor" title="Link to this definition">#</a></dt>
<dd><p>converts the instance of the class to a Pytorch tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>add_bounds</strong> (<em>bool</em><em>, </em><em>optional</em>)  whether to add the subprior bounds to the tensor. Defaults to True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the Pytorch tensor obtained from the instance of the class</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.BasicParams.from_tensor">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_subpriors.html#BasicParams.from_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.BasicParams.from_tensor" title="Link to this definition">#</a></dt>
<dd><p>initializes an instance of the class from a Pytorch tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>Tensor</em>)  Pytorch tensor containing the parameter values, min subprior bounds and max subprior bounds</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the instance of the class</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#reflectorch.BasicParams" title="reflectorch.BasicParams">BasicParams</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.BasicParams.scale_with_q">
<span class="sig-name descname"><span class="pre">scale_with_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_subpriors.html#BasicParams.scale_with_q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.BasicParams.scale_with_q" title="Link to this definition">#</a></dt>
<dd><p>scales the parameters based on the q ratio</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q_ratio</strong> (<em>float</em>)  the scaling ratio</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.ParametricModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParametricModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_num_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_models.html#ParametricModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ParametricModel" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for parameterizations of the SLD profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>max_num_layers</strong> (<em>int</em>)  the number of layers</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.ParametricModel.param_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">param_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#reflectorch.ParametricModel.param_dim" title="Link to this definition">#</a></dt>
<dd><p>get the number of parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reflectorch.ParametricModel.sampler_strategy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sampler_strategy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reflectorch.SamplerStrategy" title="reflectorch.data_generation.priors.sampler_strategies.SamplerStrategy"><span class="pre">SamplerStrategy</span></a></em><a class="headerlink" href="#reflectorch.ParametricModel.sampler_strategy" title="Link to this definition">#</a></dt>
<dd><p>get the sampler strategy</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#reflectorch.SamplerStrategy" title="reflectorch.SamplerStrategy">SamplerStrategy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.ParametricModel.reflectivity">
<span class="sig-name descname"><span class="pre">reflectivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parametrized_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_models.html#ParametricModel.reflectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ParametricModel.reflectivity" title="Link to this definition">#</a></dt>
<dd><p>computes the reflectivity curves</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong>  the reciprocal space (q) positions</p></li>
<li><p><strong>parametrized_model</strong> (<em>Tensor</em>)  the values of the parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the computed reflectivity curves</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.ParametricModel.init_bounds">
<span class="sig-name descname"><span class="pre">init_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_ranges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound_width_ranges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_models.html#ParametricModel.init_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ParametricModel.init_bounds" title="Link to this definition">#</a></dt>
<dd><p>initializes arrays storing individually the upper and lower bounds from the dictionaries of parameter and bound width ranges</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_ranges</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>)  parameter ranges</p></li>
<li><p><strong>bound_width_ranges</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>)  bound width ranges</p></li>
<li><p><strong>device</strong> (<em>optional</em>)  the Pytorch device. Defaults to None.</p></li>
<li><p><strong>dtype</strong> (<em>optional</em>)  the Pytorch datatype. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[Tensor, Tensor, Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.ParametricModel.get_param_labels">
<span class="sig-name descname"><span class="pre">get_param_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_models.html#ParametricModel.get_param_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ParametricModel.get_param_labels" title="Link to this definition">#</a></dt>
<dd><p>get the list with the name of the parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.ParametricModel.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_min_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_max_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_min_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_max_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/parametric_models.html#ParametricModel.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ParametricModel.sample" title="Link to this definition">#</a></dt>
<dd><p>samples the parameter values and their prior bounds</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>)  the batch size</p></li>
<li><p><strong>total_min_bounds</strong> (<em>Tensor</em>)  lower bounds of the parameter ranges</p></li>
<li><p><strong>total_max_bounds</strong> (<em>Tensor</em>)  upper bounds of the parameter ranges</p></li>
<li><p><strong>total_min_delta</strong> (<em>Tensor</em>)  lower widths of the subprior intervals</p></li>
<li><p><strong>total_max_delta</strong> (<em>Tensor</em>)  upper widths of the subprior intervals</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>sampled parameters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.SamplerStrategy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SamplerStrategy</span></span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/sampler_strategies.html#SamplerStrategy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.SamplerStrategy" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for sampler strategies</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.BasicSamplerStrategy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BasicSamplerStrategy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logdist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/sampler_strategies.html#BasicSamplerStrategy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.BasicSamplerStrategy" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.SamplerStrategy" title="reflectorch.data_generation.priors.sampler_strategies.SamplerStrategy"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerStrategy</span></code></a></p>
<p>Sampler strategy with no constraints on the values of the parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logdist</strong> (<em>bool</em><em>, </em><em>optional</em>)  if True the relative widths of the subprior intervals are sampled uniformly on a logarithmic scale instead of uniformly. Defaults to False.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.BasicSamplerStrategy.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_min_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_max_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_min_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_max_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/sampler_strategies.html#BasicSamplerStrategy.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.BasicSamplerStrategy.sample" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>)  the batch size</p></li>
<li><p><strong>total_min_bounds</strong> (<em>Tensor</em>)  mimimum values of the parameters</p></li>
<li><p><strong>total_max_bounds</strong> (<em>Tensor</em>)  maximum values of the parameters</p></li>
<li><p><strong>total_min_delta</strong> (<em>Tensor</em>)  minimum widths of the subprior intervals</p></li>
<li><p><strong>total_max_delta</strong> (<em>Tensor</em>)  maximum widths of the subprior intervals</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>samples the values of the parameters and their prior bounds (params, min_bounds, max_bounds). The widths W of the subprior interval are sampled first, then the centers C of the subprior interval, such that the prior bounds are C-W/2 and C+W/2, then the parameters are sampled from [C-W/2, C+W/2] )</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple(Tensor)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.ConstrainedRoughnessSamplerStrategy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConstrainedRoughnessSamplerStrategy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thickness_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roughness_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logdist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_thickness_share</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_total_thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/sampler_strategies.html#ConstrainedRoughnessSamplerStrategy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ConstrainedRoughnessSamplerStrategy" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.BasicSamplerStrategy" title="reflectorch.data_generation.priors.sampler_strategies.BasicSamplerStrategy"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasicSamplerStrategy</span></code></a></p>
<p>Sampler strategy where the roughnesses are constrained not to exceed a fraction of the two neighboring thicknesses</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thickness_mask</strong> (<em>Tensor</em>)  indices in the tensors which correspond to thicknesses</p></li>
<li><p><strong>roughness_mask</strong> (<em>Tensor</em>)  indices in the tensors which correspond to roughnesses</p></li>
<li><p><strong>logdist</strong> (<em>bool</em><em>, </em><em>optional</em>)  if <code class="docutils literal notranslate"><span class="pre">True</span></code> the relative widths of the subprior intervals are sampled uniformly on a logarithmic scale instead of uniformly. Defaults to False.</p></li>
<li><p><strong>max_thickness_share</strong> (<em>float</em><em>, </em><em>optional</em>)  fraction of the layer thickness that the roughness should not exceed. Defaults to 0.5.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.ConstrainedRoughnessSamplerStrategy.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_min_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_max_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_min_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_max_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/sampler_strategies.html#ConstrainedRoughnessSamplerStrategy.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ConstrainedRoughnessSamplerStrategy.sample" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>)  the batch size</p></li>
<li><p><strong>total_min_bounds</strong> (<em>Tensor</em>)  mimimum values of the parameters</p></li>
<li><p><strong>total_max_bounds</strong> (<em>Tensor</em>)  maximum values of the parameters</p></li>
<li><p><strong>total_min_delta</strong> (<em>Tensor</em>)  minimum widths of the subprior intervals</p></li>
<li><p><strong>total_max_delta</strong> (<em>Tensor</em>)  maximum widths of the subprior intervals</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>samples the values of the parameters and their prior bounds <em>(params, min_bounds, max_bounds)</em>, the roughnesses being constrained. The widths <strong>W</strong> of the subprior interval are sampled first, then the centers <strong>C</strong> of the subprior interval, such that the prior bounds are <strong>C</strong> - <strong>W</strong> / 2 and <strong>C</strong> + <strong>W</strong> / 2, then the parameters are sampled from [<strong>C</strong> - <strong>W</strong> / 2, <strong>C</strong> + <strong>W</strong> / 2] )</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple(Tensor)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.ConstrainedRoughnessAndImgSldSamplerStrategy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConstrainedRoughnessAndImgSldSamplerStrategy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thickness_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roughness_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sld_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isld_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logdist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_thickness_share</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sld_share</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_total_thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/sampler_strategies.html#ConstrainedRoughnessAndImgSldSamplerStrategy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ConstrainedRoughnessAndImgSldSamplerStrategy" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.BasicSamplerStrategy" title="reflectorch.data_generation.priors.sampler_strategies.BasicSamplerStrategy"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasicSamplerStrategy</span></code></a></p>
<p>Sampler strategy where the roughnesses are constrained not to exceed a fraction of the two neighboring thicknesses, and the imaginary slds are constrained not to exceed a fraction of the real slds</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thickness_mask</strong> (<em>Tensor</em>)  indices in the tensors which correspond to thicknesses</p></li>
<li><p><strong>roughness_mask</strong> (<em>Tensor</em>)  indices in the tensors which correspond to roughnesses</p></li>
<li><p><strong>sld_mask</strong> (<em>Tensor</em>)  indices in the tensors which correspond to real slds</p></li>
<li><p><strong>isld_mask</strong> (<em>Tensor</em>)  indices in the tensors which correspond to imaginary slds</p></li>
<li><p><strong>logdist</strong> (<em>bool</em><em>, </em><em>optional</em>)  if <code class="docutils literal notranslate"><span class="pre">True</span></code> the relative widths of the subprior intervals are sampled uniformly on a logarithmic scale instead of uniformly. Defaults to False.</p></li>
<li><p><strong>max_thickness_share</strong> (<em>float</em><em>, </em><em>optional</em>)  fraction of the layer thickness that the roughness should not exceed. Defaults to 0.5</p></li>
<li><p><strong>max_sld_share</strong> (<em>float</em><em>, </em><em>optional</em>)  fraction of the real sld that the imaginary sld should not exceed. Defaults to 0.2.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.ConstrainedRoughnessAndImgSldSamplerStrategy.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_min_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_max_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_min_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_max_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/data_generation/priors/sampler_strategies.html#ConstrainedRoughnessAndImgSldSamplerStrategy.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ConstrainedRoughnessAndImgSldSamplerStrategy.sample" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>)  the batch size</p></li>
<li><p><strong>total_min_bounds</strong> (<em>Tensor</em>)  mimimum values of the parameters</p></li>
<li><p><strong>total_max_bounds</strong> (<em>Tensor</em>)  maximum values of the parameters</p></li>
<li><p><strong>total_min_delta</strong> (<em>Tensor</em>)  minimum widths of the subprior intervals</p></li>
<li><p><strong>total_max_delta</strong> (<em>Tensor</em>)  maximum widths of the subprior intervals</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>samples the values of the parameters and their prior bounds <em>(params, min_bounds, max_bounds)</em>, the roughnesses and imaginary slds being constrained. The widths <strong>W</strong> of the subprior interval are sampled first, then the centers <strong>C</strong> of the subprior interval, such that the prior bounds are <strong>C</strong> - <strong>W</strong> /2 and <strong>C</strong> + <strong>W</strong> / 2, then the parameters are sampled from [<strong>C</strong> - <strong>W</strong> / 2, <strong>C</strong> + <strong>W</strong> / 2] )</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple(Tensor)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.Trainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">~torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader:</span> <span class="pre">~reflectorch.ml.basic_trainer.DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr:</span> <span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_grad_norm_max:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger:</span> <span class="pre">~reflectorch.ml.loggers.Logger</span> <span class="pre">|</span> <span class="pre">~typing.Tuple[~reflectorch.ml.loggers.Logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...]</span> <span class="pre">|</span> <span class="pre">~reflectorch.ml.loggers.Loggers</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_cls:</span> <span class="pre">~typing.Type[~torch.optim.optimizer.Optimizer]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.optim.adam.Adam'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_kwargs:</span> <span class="pre">dict</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/basic_trainer.html#Trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Trainer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Trainer class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>nn.Module</em>)  neural network</p></li>
<li><p><strong>loader</strong> (<em>DataLoader</em>)  data loader</p></li>
<li><p><strong>lr</strong> (<em>float</em>)  learning rate</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>)  batch size</p></li>
<li><p><strong>clip_grad_norm</strong> (<em>int</em><em>, </em><em>optional</em>)  maximum norm for gradient clipping if it is not <code class="docutils literal notranslate"><span class="pre">None</span></code>. Defaults to None.</p></li>
<li><p><strong>logger</strong> (<em>Union</em><em>[</em><a class="reference internal" href="#reflectorch.Logger" title="reflectorch.Logger"><em>Logger</em></a><em>, </em><em>Tuple</em><em>[</em><a class="reference internal" href="#reflectorch.Logger" title="reflectorch.Logger"><em>Logger</em></a><em>, </em><em>...</em><em>]</em><em>, </em><a class="reference internal" href="#reflectorch.Loggers" title="reflectorch.Loggers"><em>Loggers</em></a><em>]</em><em>, </em><em>optional</em>)  logger. Defaults to None.</p></li>
<li><p><strong>optim_cls</strong> (<em>Type</em><em>[</em><em>torch.optim.Optimizer</em><em>]</em><em>, </em><em>optional</em>)  Pytorch optimizer. Defaults to torch.optim.Adam.</p></li>
<li><p><strong>optim_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>)  optimizer arguments. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.Trainer.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/basic_trainer.html#Trainer.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Trainer.log" title="Link to this definition">#</a></dt>
<dd><p>log data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.Trainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reflectorch.TrainerCallback" title="reflectorch.ml.basic_trainer.TrainerCallback"><span class="pre">TrainerCallback</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#reflectorch.TrainerCallback" title="reflectorch.ml.basic_trainer.TrainerCallback"><span class="pre">TrainerCallback</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_tqdm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_notebook_tqdm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_tqdm_freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_accumulation_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/basic_trainer.html#Trainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Trainer.train" title="Link to this definition">#</a></dt>
<dd><p>starts the training process</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_batches</strong> (<em>int</em>)  total number of training iterations</p></li>
<li><p><strong>callbacks</strong> (<em>Union</em><em>[</em><em>Tuple</em><em>[</em><em>'TrainerCallback'</em><em>]</em><em>, </em><em>'TrainerCallback'</em><em>]</em>)  the trainer callbacks. Defaults to ().</p></li>
<li><p><strong>disable_tqdm</strong> (<em>bool</em><em>, </em><em>optional</em>)  if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the progress bar is disabled. Defaults to False.</p></li>
<li><p><strong>use_notebook_tqdm</strong> (<em>bool</em><em>, </em><em>optional</em>)  should be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> when used in a Jupyter Notebook. Defaults to False.</p></li>
<li><p><strong>update_tqdm_freq</strong> (<em>int</em><em>, </em><em>optional</em>)  frequency for updating the progress bar. Defaults to 10.</p></li>
<li><p><strong>grad_accumulation_steps</strong> (<em>int</em><em>, </em><em>optional</em>)  number of gradient accumulation steps. Defaults to 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.Trainer.configure_optimizer">
<span class="sig-name descname"><span class="pre">configure_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optim_cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optimizer</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/basic_trainer.html#Trainer.configure_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Trainer.configure_optimizer" title="Link to this definition">#</a></dt>
<dd><p>configure the optimizer based on the optimizer class, the learning rate and the optimizer keyword arguments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optim_cls</strong>  the class of the optimizer</p></li>
<li><p><strong>lr</strong> (<em>float</em>)  the learning rate</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.optim.Optimizer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.Trainer.lr">
<span class="sig-name descname"><span class="pre">lr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_group</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/basic_trainer.html#Trainer.lr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Trainer.lr" title="Link to this definition">#</a></dt>
<dd><p>get the learning rate</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.Trainer.set_lr">
<span class="sig-name descname"><span class="pre">set_lr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_group</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/basic_trainer.html#Trainer.set_lr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Trainer.set_lr" title="Link to this definition">#</a></dt>
<dd><p>set the learning rate</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.TrainerCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TrainerCallback</span></span><a class="reference internal" href="_modules/reflectorch/ml/basic_trainer.html#TrainerCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.TrainerCallback" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for trainer callbacks</p>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.TrainerCallback.start_training">
<span class="sig-name descname"><span class="pre">start_training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/basic_trainer.html#TrainerCallback.start_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.TrainerCallback.start_training" title="Link to this definition">#</a></dt>
<dd><p>add functionality the start of training</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  the trainer object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.TrainerCallback.end_training">
<span class="sig-name descname"><span class="pre">end_training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/basic_trainer.html#TrainerCallback.end_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.TrainerCallback.end_training" title="Link to this definition">#</a></dt>
<dd><p>add functionality at the end of training</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  the trainer object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.TrainerCallback.end_batch">
<span class="sig-name descname"><span class="pre">end_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/basic_trainer.html#TrainerCallback.end_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.TrainerCallback.end_batch" title="Link to this definition">#</a></dt>
<dd><p>add functionality at the end of the iteration / batch</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  the trainer object</p></li>
<li><p><strong>batch_num</strong> (<em>int</em>)  the index of the current iteration / batch</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[bool, None]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.PeriodicTrainerCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PeriodicTrainerCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/basic_trainer.html#PeriodicTrainerCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.PeriodicTrainerCallback" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.TrainerCallback" title="reflectorch.ml.basic_trainer.TrainerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainerCallback</span></code></a></p>
<p>Base class for trainer callbacks which perform an action periodically after a number of iterations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> (<em>int</em><em>, </em><em>optional</em>)  Number of iterations after which the action is repeated. Defaults to 1.</p></li>
<li><p><strong>last_epoch</strong> (<em>int</em><em>, </em><em>optional</em>)  the last training  iteration for which the action is performed. Defaults to -1.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.PeriodicTrainerCallback.end_batch">
<span class="sig-name descname"><span class="pre">end_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/basic_trainer.html#PeriodicTrainerCallback.end_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.PeriodicTrainerCallback.end_batch" title="Link to this definition">#</a></dt>
<dd><p>add functionality at the end of the iteration / batch</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  the trainer object</p></li>
<li><p><strong>batch_num</strong> (<em>int</em>)  the index of the current iteration / batch</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[bool, None]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.SaveBestModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SaveBestModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/callbacks.html#SaveBestModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.SaveBestModel" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.TrainerCallback" title="reflectorch.ml.basic_trainer.TrainerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainerCallback</span></code></a></p>
<p>Callback for periodically saving the best model weights</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>)  path for saving the model weights</p></li>
<li><p><strong>freq</strong> (<em>int</em><em>, </em><em>optional</em>)  frequency in iterations at which the current average loss is evaluated. Defaults to 50.</p></li>
<li><p><strong>average</strong> (<em>int</em><em>, </em><em>optional</em>)  number of recent iterations over which the average loss is computed. Defaults to 10.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.SaveBestModel.end_batch">
<span class="sig-name descname"><span class="pre">end_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/callbacks.html#SaveBestModel.end_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.SaveBestModel.end_batch" title="Link to this definition">#</a></dt>
<dd><p>checks if the current average loss has improved from the previous save, if true the model is saved</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  the trainer object</p></li>
<li><p><strong>batch_num</strong> (<em>int</em>)  the current iteration / batch</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.SaveBestModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/callbacks.html#SaveBestModel.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.SaveBestModel.save" title="Link to this definition">#</a></dt>
<dd><p>saves a dictionary containing the network weights, the learning rates, the losses and the current             best loss with its corresponding iteration to the disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  the trainer object</p></li>
<li><p><strong>batch_num</strong> (<em>int</em>)  the current iteration / batch</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.LogLosses">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LogLosses</span></span><a class="reference internal" href="_modules/reflectorch/ml/callbacks.html#LogLosses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.LogLosses" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.TrainerCallback" title="reflectorch.ml.basic_trainer.TrainerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainerCallback</span></code></a></p>
<p>Callback for logging the training losses</p>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.LogLosses.end_batch">
<span class="sig-name descname"><span class="pre">end_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/callbacks.html#LogLosses.end_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.LogLosses.end_batch" title="Link to this definition">#</a></dt>
<dd><p>log loss at the current iteration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  the trainer object</p></li>
<li><p><strong>batch_num</strong> (<em>int</em>)  the index of the current iteration / batch</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.Logger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Logger</span></span><a class="reference internal" href="_modules/reflectorch/ml/loggers.html#Logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Logger" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class defining a common interface for logging</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.Loggers">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Loggers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">loggers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/loggers.html#Loggers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.Loggers" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.Logger" title="reflectorch.ml.loggers.Logger"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></a></p>
<p>Class for using multiple loggers</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.PrintLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PrintLogger</span></span><a class="reference internal" href="_modules/reflectorch/ml/loggers.html#PrintLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.PrintLogger" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.Logger" title="reflectorch.ml.loggers.Logger"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></a></p>
<p>Logger which prints to the console</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.TensorBoardLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TensorBoardLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/loggers.html#TensorBoardLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.TensorBoardLogger" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.Logger" title="reflectorch.ml.loggers.Logger"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.TensorBoardLogger.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/loggers.html#TensorBoardLogger.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.TensorBoardLogger.log" title="Link to this definition">#</a></dt>
<dd><p>Log scalar data to TensorBoard</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>)  Name/tag for the data</p></li>
<li><p><strong>data</strong>  Scalar value to log</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.ScheduleBatchSize">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ScheduleBatchSize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'add'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#ScheduleBatchSize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ScheduleBatchSize" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.PeriodicTrainerCallback" title="reflectorch.ml.basic_trainer.PeriodicTrainerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeriodicTrainerCallback</span></code></a></p>
<p>Batch size scheduler</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> (<em>int</em>)  number of iterations after which the batch size is modified.</p></li>
<li><p><strong>gamma</strong> (<em>int</em><em>, </em><em>optional</em>)  quantity which is added to or multiplied with the current batch size. Defaults to 2.</p></li>
<li><p><strong>last_epoch</strong> (<em>int</em><em>, </em><em>optional</em>)  the last training iteration for which the batch size is modified. Defaults to -1.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>)  <code class="docutils literal notranslate"><span class="pre">'add'</span></code> for addition or <code class="docutils literal notranslate"><span class="pre">'multiply'</span></code> for multiplication. Defaults to add.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.ScheduleLR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ScheduleLR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lr_scheduler_cls</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#ScheduleLR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ScheduleLR" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.TrainerCallback" title="reflectorch.ml.basic_trainer.TrainerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainerCallback</span></code></a></p>
<p>Base class for learning rate schedulers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lr_scheduler_cls</strong>  class of the learning rate scheduler</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.ScheduleLR.start_training">
<span class="sig-name descname"><span class="pre">start_training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#ScheduleLR.start_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ScheduleLR.start_training" title="Link to this definition">#</a></dt>
<dd><p>initializes a learning rate scheduler based on its class and keyword arguments at the start of training</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  the trainer object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.ScheduleLR.end_batch">
<span class="sig-name descname"><span class="pre">end_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#ScheduleLR.end_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ScheduleLR.end_batch" title="Link to this definition">#</a></dt>
<dd><p>modifies the learning rate at the end of each iteration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  the trainer object</p></li>
<li><p><strong>batch_num</strong> (<em>int</em>)  index of the current iteration</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.StepLR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StepLR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#StepLR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.StepLR" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.ScheduleLR" title="reflectorch.ml.schedulers.ScheduleLR"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScheduleLR</span></code></a></p>
<p>Learning rate scheduler which decays the learning rate of each parameter group by gamma every <code class="docutils literal notranslate"><span class="pre">step_size</span></code> epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_size</strong> (<em>int</em>)  Period of learning rate decay</p></li>
<li><p><strong>gamma</strong> (<em>float</em>)  Multiplicative factor of learning rate decay</p></li>
<li><p><strong>last_epoch</strong> (<em>int</em><em>, </em><em>optional</em>)  The index of last iteration. Defaults to -1.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.StepLR.start_training">
<span class="sig-name descname"><span class="pre">start_training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#StepLR.start_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.StepLR.start_training" title="Link to this definition">#</a></dt>
<dd><p>initializes a learning rate scheduler based on its class and keyword arguments at the start of training</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  the trainer object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.CyclicLR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CyclicLR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_lr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size_up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cycle_momentum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'triangular'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#CyclicLR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.CyclicLR" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.ScheduleLR" title="reflectorch.ml.schedulers.ScheduleLR"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScheduleLR</span></code></a></p>
<p>Cyclic learning rate scheduler</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_lr</strong> (<em>float</em>)  Initial learning rate which is the lower boundary in the cycle</p></li>
<li><p><strong>max_lr</strong> (<em>float</em>)  Upper learning rate boundary in the cycle</p></li>
<li><p><strong>step_size_up</strong> (<em>int</em><em>, </em><em>optional</em>)  Number of training iterations in the increasing half of a cycle. Defaults to 2000.</p></li>
<li><p><strong>cycle_momentum</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, momentum is cycled inversely to learning rate between <code class="docutils literal notranslate"><span class="pre">base_momentum</span></code> and <code class="docutils literal notranslate"><span class="pre">max_momentum</span></code>. Defaults to False.</p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>optional</em>)  Constant in <code class="docutils literal notranslate"><span class="pre">exp_range</span></code> mode scaling function: gamma^(cycle iterations). Defaults to 1.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>)  One of: <code class="docutils literal notranslate"><span class="pre">'triangular'</span></code> (a basic triangular cycle without amplitude scaling),
<code class="docutils literal notranslate"><span class="pre">'triangular2'</span></code> (a basic triangular cycle that scales initial amplitude by half each cycle), <code class="docutils literal notranslate"><span class="pre">'exp_range'</span></code>
(a cycle that scales initial amplitude by gamma^iterations at each cycle iteration). Defaults to triangular.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.LogCyclicLR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LogCyclicLR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_lr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_period</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">25</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#LogCyclicLR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.LogCyclicLR" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.TrainerCallback" title="reflectorch.ml.basic_trainer.TrainerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainerCallback</span></code></a></p>
<p>Cyclic learning rate scheduler on a logarithmic scale</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_lr</strong> (<em>float</em>)  Lower learning rate boundary in the cycle</p></li>
<li><p><strong>max_lr</strong> (<em>float</em>)  Upper learning rate boundary in the cycle</p></li>
<li><p><strong>period</strong> (<em>int</em><em>, </em><em>optional</em>)  Number of training iterations in the cycle. Defaults to 2000.</p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>optional</em>)  Constant for scaling the amplitude as <code class="docutils literal notranslate"><span class="pre">gamma</span></code> ^ <code class="docutils literal notranslate"><span class="pre">iterations</span></code>. Defaults to 1.</p></li>
<li><p><strong>start_period</strong> (<em>int</em><em>, </em><em>optional</em>)  Number of starting iterations with the default learning rate.</p></li>
<li><p><strong>log</strong> (<em>bool</em><em>, </em><em>optional</em>)  If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the cycle is in the logarithmic domain.</p></li>
<li><p><strong>param_groups</strong> (<em>tupe</em><em>, </em><em>optional</em>)  Parameter groups of the optimizer.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.LogCyclicLR.end_batch">
<span class="sig-name descname"><span class="pre">end_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#LogCyclicLR.end_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.LogCyclicLR.end_batch" title="Link to this definition">#</a></dt>
<dd><p>add functionality at the end of the iteration / batch</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  the trainer object</p></li>
<li><p><strong>batch_num</strong> (<em>int</em>)  the index of the current iteration / batch</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[bool, None]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.ReduceLROnPlateau">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ReduceLROnPlateau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'total_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#ReduceLROnPlateau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ReduceLROnPlateau" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.TrainerCallback" title="reflectorch.ml.basic_trainer.TrainerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainerCallback</span></code></a></p>
<p>Learning rate scheduler which reduces the learning rate when the loss stops decreasing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>optional</em>)  Multiplicative factor of learning rate decay. Defaults to 0.5.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>optional</em>)  The number of allowed iterations with no improvement after which the learning rate will be reduced. Defaults to 500.</p></li>
<li><p><strong>average</strong> (<em>int</em><em>, </em><em>optional</em>)  Size of the window over which the average loss is computed. Defaults to 50.</p></li>
<li><p><strong>loss_key</strong> (<em>str</em><em>, </em><em>optional</em>)  Defaults to total_loss.</p></li>
<li><p><strong>param_groups</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Defaults to (0,).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.ReduceLROnPlateau.end_batch">
<span class="sig-name descname"><span class="pre">end_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#ReduceLROnPlateau.end_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ReduceLROnPlateau.end_batch" title="Link to this definition">#</a></dt>
<dd><p>add functionality at the end of the iteration / batch</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  the trainer object</p></li>
<li><p><strong>batch_num</strong> (<em>int</em>)  the index of the current iteration / batch</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[bool, None]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.OneCycleLR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OneCycleLR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pct_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">div_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_div_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">three_phase</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#OneCycleLR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.OneCycleLR" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.ScheduleLR" title="reflectorch.ml.schedulers.ScheduleLR"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScheduleLR</span></code></a></p>
<p>One-cycle learning rate scheduler (<a class="reference external" href="https://arxiv.org/abs/1708.07120">https://arxiv.org/abs/1708.07120</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_lr</strong> (<em>float</em>)  Upper learning rate boundary in the cycle</p></li>
<li><p><strong>total_steps</strong> (<em>int</em>)  The total number of steps in the cycle</p></li>
<li><p><strong>pct_start</strong> (<em>float</em><em>, </em><em>optional</em>)  The percentage of the cycle (in number of steps) spent increasing the learning rate. Defaults to 0.3.</p></li>
<li><p><strong>div_factor</strong> (<em>float</em><em>, </em><em>optional</em>)  Determines the initial learning rate via initial_lr = <code class="docutils literal notranslate"><span class="pre">max_lr</span></code> / <code class="docutils literal notranslate"><span class="pre">div_factor</span></code>. Defaults to 25..</p></li>
<li><p><strong>final_div_factor</strong> (<em>float</em><em>, </em><em>optional</em>)  Determines the minimum learning rate via min_lr = <code class="docutils literal notranslate"><span class="pre">initial_lr</span></code> / <code class="docutils literal notranslate"><span class="pre">final_div_factor</span></code>. Defaults to 1e4.</p></li>
<li><p><strong>three_phase</strong> (<em>bool</em><em>, </em><em>optional</em>)  If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use a third phase of the schedule to annihilate the learning rate according to <code class="docutils literal notranslate"><span class="pre">final_div_factor</span></code> instead of modifying the second phase. Defaults to True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.CosineAnnealingWithWarmup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CosineAnnealingWithWarmup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#CosineAnnealingWithWarmup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.CosineAnnealingWithWarmup" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.TrainerCallback" title="reflectorch.ml.basic_trainer.TrainerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainerCallback</span></code></a></p>
<p>Cosine annealing scheduler with a warm-up stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_lr</strong> (<em>float</em>)  The maximum learning rate after the warm-up phase.</p></li>
<li><p><strong>min_lr</strong> (<em>float</em>)  The minimum learning rate after the warm-up phase.</p></li>
<li><p><strong>warmup_iters</strong> (<em>int</em>)  The number of iterations for the warm-up phase.</p></li>
<li><p><strong>total_iters</strong> (<em>int</em>)  The total number of iterations for the scheduler (including warm-up).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.CosineAnnealingWithWarmup.get_lr">
<span class="sig-name descname"><span class="pre">get_lr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#CosineAnnealingWithWarmup.get_lr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.CosineAnnealingWithWarmup.get_lr" title="Link to this definition">#</a></dt>
<dd><p>Compute the learning rate for a given iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<em>int</em>)  The current iteration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The learning rate for the current iteration.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.CosineAnnealingWithWarmup.start_training">
<span class="sig-name descname"><span class="pre">start_training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#CosineAnnealingWithWarmup.start_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.CosineAnnealingWithWarmup.start_training" title="Link to this definition">#</a></dt>
<dd><p>add functionality the start of training</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  the trainer object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.CosineAnnealingWithWarmup.end_batch">
<span class="sig-name descname"><span class="pre">end_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#CosineAnnealingWithWarmup.end_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.CosineAnnealingWithWarmup.end_batch" title="Link to this definition">#</a></dt>
<dd><p>Updates the learning rate at the end of each batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer"><em>Trainer</em></a>)  The trainer object.</p></li>
<li><p><strong>batch_num</strong> (<em>int</em>)  The current batch number.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.CosineAnnealingWithWarmup.simulate_and_plot">
<span class="sig-name descname"><span class="pre">simulate_and_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/schedulers.html#CosineAnnealingWithWarmup.simulate_and_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.CosineAnnealingWithWarmup.simulate_and_plot" title="Link to this definition">#</a></dt>
<dd><p>Simulates and plots the learning rate evolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>total_batches</strong> (<em>int</em><em>, </em><em>optional</em>)  Total number of batches to simulate. If None, uses self.total_iters.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.ReflectivityDataLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ReflectivityDataLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.QGenerator" title="reflectorch.data_generation.q_generator.QGenerator"><span class="pre">QGenerator</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.PriorSampler" title="reflectorch.data_generation.priors.base.PriorSampler"><span class="pre">PriorSampler</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity_noise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.IntensityNoiseGenerator" title="reflectorch.data_generation.noise.IntensityNoiseGenerator"><span class="pre">IntensityNoiseGenerator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_noise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.QNoiseGenerator" title="reflectorch.data_generation.noise.QNoiseGenerator"><span class="pre">QNoiseGenerator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curves_scaler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.CurvesScaler" title="reflectorch.data_generation.scale_curves.CurvesScaler"><span class="pre">CurvesScaler</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_denoised_curves</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_nonsmeared_curves</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smearing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.Smearing" title="reflectorch.data_generation.smearing.Smearing"><span class="pre">Smearing</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/dataloaders.html#ReflectivityDataLoader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ReflectivityDataLoader" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.BasicDataset" title="reflectorch.data_generation.dataset.BasicDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasicDataset</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></p>
<p>Dataloader for reflectivity data, combining functionality from the <code class="docutils literal notranslate"><span class="pre">BasicDataset</span></code> (basic dataset class for reflectivity) and the <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> (which inherits from <code class="docutils literal notranslate"><span class="pre">TrainerCallback</span></code>) classes</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.RealTimeSimTrainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RealTimeSimTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">~torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader:</span> <span class="pre">~reflectorch.ml.basic_trainer.DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr:</span> <span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_grad_norm_max:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger:</span> <span class="pre">~reflectorch.ml.loggers.Logger</span> <span class="pre">|</span> <span class="pre">~typing.Tuple[~reflectorch.ml.loggers.Logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...]</span> <span class="pre">|</span> <span class="pre">~reflectorch.ml.loggers.Loggers</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_cls:</span> <span class="pre">~typing.Type[~torch.optim.optimizer.Optimizer]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.optim.adam.Adam'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_kwargs:</span> <span class="pre">dict</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/trainers.html#RealTimeSimTrainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.RealTimeSimTrainer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.ml.basic_trainer.Trainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trainer</span></code></a></p>
<p>Trainer with functionality to customize the sampled batch of data</p>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.RealTimeSimTrainer.get_batch_by_idx">
<span class="sig-name descname"><span class="pre">get_batch_by_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/trainers.html#RealTimeSimTrainer.get_batch_by_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.RealTimeSimTrainer.get_batch_by_idx" title="Link to this definition">#</a></dt>
<dd><p>Gets a batch of data with the default batch size</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.RealTimeSimTrainer.get_batch_by_size">
<span class="sig-name descname"><span class="pre">get_batch_by_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/trainers.html#RealTimeSimTrainer.get_batch_by_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.RealTimeSimTrainer.get_batch_by_size" title="Link to this definition">#</a></dt>
<dd><p>Gets a batch of data with a custom batch size</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.PointEstimatorTrainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PointEstimatorTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">~torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader:</span> <span class="pre">~reflectorch.ml.basic_trainer.DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr:</span> <span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_grad_norm_max:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger:</span> <span class="pre">~reflectorch.ml.loggers.Logger</span> <span class="pre">|</span> <span class="pre">~typing.Tuple[~reflectorch.ml.loggers.Logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...]</span> <span class="pre">|</span> <span class="pre">~reflectorch.ml.loggers.Loggers</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_cls:</span> <span class="pre">~typing.Type[~torch.optim.optimizer.Optimizer]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.optim.adam.Adam'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_kwargs:</span> <span class="pre">dict</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/trainers.html#PointEstimatorTrainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.PointEstimatorTrainer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.RealTimeSimTrainer" title="reflectorch.ml.trainers.RealTimeSimTrainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">RealTimeSimTrainer</span></code></a></p>
<p>Point estimator trainer for the inverse problem.</p>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.PointEstimatorTrainer.get_loss_dict">
<span class="sig-name descname"><span class="pre">get_loss_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BasicBatchData</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/ml/trainers.html#PointEstimatorTrainer.get_loss_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.PointEstimatorTrainer.get_loss_dict" title="Link to this definition">#</a></dt>
<dd><p>Returns the regression loss</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.ConvEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConvEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(32,</span> <span class="pre">64,</span> <span class="pre">128,</span> <span class="pre">256,</span> <span class="pre">512)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_avpool</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_batch_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_se</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'relu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/models/encoders/conv_encoder.html#ConvEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ConvEncoder" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A 1D CNN encoder / embedding network</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em><em>, </em><em>optional</em>)  the number of input channels. Defaults to 1.</p></li>
<li><p><strong>hidden_channels</strong> (<em>tuple</em><em>, </em><em>optional</em>)  the number of intermediate channels of each convolutional layer. Defaults to (32, 64, 128, 256, 512).</p></li>
<li><p><strong>dim_embedding</strong> (<em>int</em><em>, </em><em>optional</em>)  the dimension of the output latent embedding. Defaults to 64.</p></li>
<li><p><strong>dim_avpool</strong> (<em>int</em><em>, </em><em>optional</em>)  the output size of the adaptive average pooling layer. Defaults to 1.</p></li>
<li><p><strong>use_batch_norm</strong> (<em>bool</em><em>, </em><em>optional</em>)  whether to use batch normalization. Defaults to True.</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>)  the type of activation function. Defaults to relu.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.ConvEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/models/encoders/conv_encoder.html#ConvEncoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.ConvEncoder.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.FnoEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FnoEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_fno</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_fno_blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gelu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fusion_self_attention</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsa_activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'tanh'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/models/encoders/fno.html#FnoEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.FnoEncoder" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>An embedding network based on the Fourier Neural Operator (FNO) architecture</p>
<a class="reference internal image-reference" href="_images/fig_reflectometry_embedding_networks1.png"><img alt="_images/fig_reflectometry_embedding_networks1.png" class="align-center" src="_images/fig_reflectometry_embedding_networks1.png" style="width: 400px;" /></a>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em>)  number of input channels</p></li>
<li><p><strong>dim_embedding</strong> (<em>int</em>)  dimension of the output embedding</p></li>
<li><p><strong>modes</strong> (<em>int</em>)  number of Fourier modes</p></li>
<li><p><strong>width_fno</strong> (<em>int</em>)  number of channels of the intermediate representations</p></li>
<li><p><strong>n_fno_blocks</strong> (<em>int</em>)  number of FNO blocks</p></li>
<li><p><strong>activation</strong> (<em>str</em>)  the activation function</p></li>
<li><p><strong>fusion_self_attention</strong> (<em>bool</em>)  whether to use fusion self attention for merging the tokens (instead of mean)</p></li>
<li><p><strong>fsa_activation</strong> (<em>str</em>)  the activation function of the fusion self attention block</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.NetworkWithPriors">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NetworkWithPriors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding_net_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_net_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained_embedding_net</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_conditioning_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeats_per_block</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gelu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_batch_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_layer_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tanh_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_selu_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditioning</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'concat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat_condition_first_layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/models/networks/mlp_networks.html#NetworkWithPriors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.NetworkWithPriors" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>MLP network with an embedding network</p>
<a class="reference internal image-reference" href="_images/FigureReflectometryNetwork1.png"><img alt="_images/FigureReflectometryNetwork1.png" class="align-center" src="_images/FigureReflectometryNetwork1.png" style="width: 800px;" /></a>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>embedding_net_type</strong> (<em>str</em>)  the type of embedding network, either conv or fno.</p></li>
<li><p><strong>embedding_net_kwargs</strong> (<em>dict</em>)  dictionary containing the keyword arguments for the embedding network.</p></li>
<li><p><strong>dim_out</strong> (<em>int</em><em>, </em><em>optional</em>)  the dimension of the output produced by the MLP. Defaults to 8.</p></li>
<li><p><strong>dim_conditioning_params</strong> (<em>int</em><em>, </em><em>optional</em>)  the dimension of other parameters the network is conditioned on (e.g. for the smearing coefficient dq/q)</p></li>
<li><p><strong>layer_width</strong> (<em>int</em><em>, </em><em>optional</em>)  the width of a linear layer in the MLP. Defaults to 512.</p></li>
<li><p><strong>num_blocks</strong> (<em>int</em><em>, </em><em>optional</em>)  the number of residual blocks in the MLP. Defaults to 4.</p></li>
<li><p><strong>repeats_per_block</strong> (<em>int</em><em>, </em><em>optional</em>)  the number of normalization/activation/linear repeats in a block. Defaults to 2.</p></li>
<li><p><strong>mlp_activation</strong> (<em>str</em><em>, </em><em>optional</em>)  the type of activation function in the MLP. Defaults to gelu.</p></li>
<li><p><strong>use_batch_norm</strong> (<em>bool</em><em>, </em><em>optional</em>)  whether to use batch normalization in the MLP. Defaults to True.</p></li>
<li><p><strong>use_layer_norm</strong> (<em>bool</em><em>, </em><em>optional</em>)  whether to use layer normalization in the MLP (if use_batch_norm is False). Defaults to False.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>)  dropout rate for each block. Defaults to 0.0.</p></li>
<li><p><strong>tanh_output</strong> (<em>bool</em><em>, </em><em>optional</em>)  whether to apply a tanh function to the output. Defaults to False.</p></li>
<li><p><strong>use_selu_init</strong> (<em>bool</em><em>, </em><em>optional</em>)  whether to use the special weights initialization for the selu activation function. Defaults to False.</p></li>
<li><p><strong>pretrained_embedding_net</strong> (<em>str</em><em>, </em><em>optional</em>)  the path to the weights of a pretrained embedding network. Defaults to None.</p></li>
<li><p><strong>residual</strong> (<em>bool</em><em>, </em><em>optional</em>)  whether the blocks have a residual skip connection. Defaults to True.</p></li>
<li><p><strong>adaptive_activation</strong> (<em>bool</em><em>, </em><em>optional</em>)  must be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if the activation function is adaptive. Defaults to False.</p></li>
<li><p><strong>conditioning</strong> (<em>str</em><em>, </em><em>optional</em>)  the manner in which the prior bounds are provided as input to the network. Defaults to concat.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.NetworkWithPriors.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curves</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditioning_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/models/networks/mlp_networks.html#NetworkWithPriors.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.NetworkWithPriors.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scaled_curves</strong> (<em>torch.Tensor</em>)  Input tensor of shape [batch_size, n_points] or [batch_size, n_channels, n_points].</p></li>
<li><p><strong>scaled_bounds</strong> (<em>torch.Tensor</em>)  Tensor representing prior bounds, shape [batch_size, 2*n_params].</p></li>
<li><p><strong>scaled_q_values</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>)  Tensor of shape [batch_size, n_points].</p></li>
<li><p><strong>scaled_conditioning_params</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>)  Additional parameters for conditioning, shape [batch_size, ].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.NetworkWithPriorsConvEmb">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NetworkWithPriorsConvEmb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/models/networks/mlp_networks.html#NetworkWithPriorsConvEmb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.NetworkWithPriorsConvEmb" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.NetworkWithPriors" title="reflectorch.models.networks.mlp_networks.NetworkWithPriors"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetworkWithPriors</span></code></a></p>
<p>Wrapper for back-compatibility with previous versions of the package</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.NetworkWithPriorsFnoEmb">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NetworkWithPriorsFnoEmb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/models/networks/mlp_networks.html#NetworkWithPriorsFnoEmb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.NetworkWithPriorsFnoEmb" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reflectorch.NetworkWithPriors" title="reflectorch.models.networks.mlp_networks.NetworkWithPriors"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetworkWithPriors</span></code></a></p>
<p>Wrapper for back-compatibility with previous versions of the package</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.to_np">
<span class="sig-name descname"><span class="pre">to_np</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/utils.html#to_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.to_np" title="Link to this definition">#</a></dt>
<dd><p>Converts Pytorch tensor or Python list to Numpy array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>torch.Tensor</em><em> or </em><em>list</em>)  Input Pytorch tensor or Python list</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted Numpy array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.to_t">
<span class="sig-name descname"><span class="pre">to_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/utils.html#to_t"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.to_t" title="Link to this definition">#</a></dt>
<dd><p>Converts Numpy array or Python list to Pytorch tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>numpy.ndarray</em><em> or </em><em>list</em>)  Input</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em> or </em><em>str</em><em>, </em><em>optional</em>)  device for the tensor (cpu, cuda)</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>)  data type of the tensor (e.g. torch.float32)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>converted Pytorch tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.train_from_config">
<span class="sig-name descname"><span class="pre">train_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/runs/utils.html#train_from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.train_from_config" title="Link to this definition">#</a></dt>
<dd><p>Train a model from a configuration dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>)  configuration dictionary</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the trainer object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer">Trainer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.get_trainer_from_config">
<span class="sig-name descname"><span class="pre">get_trainer_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/runs/utils.html#get_trainer_from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.get_trainer_from_config" title="Link to this definition">#</a></dt>
<dd><p>Initializes a trainer from a configuration dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>dict</em>)  the configuration dictionary</p></li>
<li><p><strong>folder_paths</strong> (<em>dict</em><em>, </em><em>optional</em>)  dictionary containing the folder paths</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the trainer object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer">Trainer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.get_paths_from_config">
<span class="sig-name descname"><span class="pre">get_paths_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mkdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/runs/utils.html#get_paths_from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.get_paths_from_config" title="Link to this definition">#</a></dt>
<dd><p>Get the directory paths from a configuration dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>dict</em>)  configuration dictionary</p></li>
<li><p><strong>mkdir</strong> (<em>bool</em><em>, </em><em>optional</em>)  option to create a new directory for the saved model weights and losses.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary containing the folder paths</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.get_callbacks_from_config">
<span class="sig-name descname"><span class="pre">get_callbacks_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reflectorch.TrainerCallback" title="reflectorch.ml.basic_trainer.TrainerCallback"><span class="pre">TrainerCallback</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/reflectorch/runs/utils.html#get_callbacks_from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.get_callbacks_from_config" title="Link to this definition">#</a></dt>
<dd><p>Initializes the training callbacks from a configuration dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of callbacks</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.get_trainer_by_name">
<span class="sig-name descname"><span class="pre">get_trainer_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inference_device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/runs/utils.html#get_trainer_by_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.get_trainer_by_name" title="Link to this definition">#</a></dt>
<dd><p>Initializes a trainer object based on a configuration file (i.e. the model name) and optionally loads         saved weights into the network</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config_name</strong> (<em>str</em>)  name of the configuration file</p></li>
<li><p><strong>config_dir</strong> (<em>str</em>)  path of the configuration directory</p></li>
<li><p><strong>model_path</strong> (<em>str</em><em>, </em><em>optional</em>)  path to the network weights. The default path is saved_models located in the package directory</p></li>
<li><p><strong>load_weights</strong> (<em>bool</em><em>, </em><em>optional</em>)  if True the saved network weights are loaded into the network. Defaults to True.</p></li>
<li><p><strong>inference_device</strong> (<em>str</em><em>, </em><em>optional</em>)  overwrites the device in the configuration file for the purpose of inference on a different device then the training was performed on. Defaults to cuda.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the trainer object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#reflectorch.Trainer" title="reflectorch.Trainer">Trainer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.convert_pt_to_safetensors">
<span class="sig-name descname"><span class="pre">convert_pt_to_safetensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/runs/utils.html#convert_pt_to_safetensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.convert_pt_to_safetensors" title="Link to this definition">#</a></dt>
<dd><p>Creates .safetensors files for all the model state dictionaries inside .pt files in the specified directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_dir</strong> (<em>str</em>)  directory containing model weights</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.load_config">
<span class="sig-name descname"><span class="pre">load_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/reflectorch/runs/config.html#load_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.load_config" title="Link to this definition">#</a></dt>
<dd><p>Loads a configuration dictionary from a YAML configuration file located in the configuration directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config_name</strong> (<em>str</em>)  name of the YAML configuration file</p></li>
<li><p><strong>config_dir</strong> (<em>str</em>)  path of the configuration directory</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the configuration dictionary</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.EasyInferenceModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EasyInferenceModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'safetensors'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repo_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'valentinsingularity/reflectivity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reflectorch.PointEstimatorTrainer" title="reflectorch.ml.trainers.PointEstimatorTrainer"><span class="pre">PointEstimatorTrainer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/inference/inference_model.html#EasyInferenceModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.EasyInferenceModel" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Facilitates the inference process using pretrained models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config_name</strong> (<em>str</em><em>, </em><em>optional</em>)  the name of the configuration file used to initialize the model (either with or without the .yaml extension). Defaults to None.</p></li>
<li><p><strong>model_name</strong> (<em>str</em><em>, </em><em>optional</em>)  the name of the file containing the weights of the model (either with or without the .pt extension), only required if different than: <cite>model_ + config_name + .pt</cite>. Defaults to None</p></li>
<li><p><strong>root_dir</strong> (<em>str</em><em>, </em><em>optional</em>)  path to root directory containing the configs and saved_models subdirectories, if different from the package root directory (ROOT_DIR). Defaults to None.</p></li>
<li><p><strong>weights_format</strong> (<em>str</em><em>, </em><em>optional</em>)  format (extension) of the weights file, either pt or safetensors. Defaults to safetensors.</p></li>
<li><p><strong>repo_id</strong> (<em>str</em><em>, </em><em>optional</em>)  the id of the Huggingface repository from which the configuration files and model weights should be downloaded automatically if not found locally (in the configs and saved_models subdirectories of the root directory). Defaults to valentinsingularity/reflectivity.</p></li>
<li><p><strong>trainer</strong> (<a class="reference internal" href="#reflectorch.PointEstimatorTrainer" title="reflectorch.PointEstimatorTrainer"><em>PointEstimatorTrainer</em></a><em>, </em><em>optional</em>)  if provided, this trainer instance is used directly instead of being initialized from the configuration file. Defaults to None.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>)  the Pytorch device (cuda or cpu). Defaults to cuda.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.EasyInferenceModel.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/reflectorch/inference/inference_model.html#EasyInferenceModel.load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.EasyInferenceModel.load_model" title="Link to this definition">#</a></dt>
<dd><p>Loads a model for inference</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config_name</strong> (<em>str</em>)  the name of the configuration file used to initialize the model (either with or without the .yaml extension).</p></li>
<li><p><strong>model_name</strong> (<em>str</em>)  the name of the file containing the weights of the model (either with or without the .pt or .safetensors  extension), only required if different than: <cite>model_ + config_name + extension</cite>.</p></li>
<li><p><strong>root_dir</strong> (<em>str</em>)  path to root directory containing the configs and saved_models subdirectories, if different from the package root directory (ROOT_DIR).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.EasyInferenceModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reflectivity_curve</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ambient_sld</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polish_prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polishing_kwargs_reflectivity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_growth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_d_change</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_q_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_pred_curve</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_pred_sld_profile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_polished_sld_profile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/inference/inference_model.html#EasyInferenceModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.EasyInferenceModel.predict" title="Link to this definition">#</a></dt>
<dd><p>Predict the thin film parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reflectivity_curve</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>Tensor</em><em>]</em>)  The reflectivity curve (which has been already preprocessed, normalized and interpolated).</p></li>
<li><p><strong>q_values</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>Tensor</em><em>]</em><em>, </em><em>optional</em>)  The momentum transfer (q) values for the reflectivity curve (in units of inverse angstroms).</p></li>
<li><p><strong>prior_bounds</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>List</em><em>[</em><em>Tuple</em><em>]</em><em>]</em><em>, </em><em>optional</em>)  the prior bounds for the thin film parameters.</p></li>
<li><p><strong>q_resolution</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>)  the instrumental resolution. Either as a float with meaning dq/q for linear smearing or as a numpy array with meaning dq for pointwise smearing.</p></li>
<li><p><strong>ambient_sld</strong> (<em>float</em><em>, </em><em>optional</em>)  the SLD of the ambient medium (fronting), if different from air.</p></li>
<li><p><strong>clip_prediction</strong> (<em>bool</em><em>, </em><em>optional</em>)  If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the values of the predicted parameters are clipped to not be outside the interval set by the prior bounds. Defaults to False.</p></li>
<li><p><strong>polish_prediction</strong> (<em>bool</em><em>, </em><em>optional</em>)  If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the neural network predictions are further polished using a simple least mean squares (LMS) fit. Only for the standard box-model parameterization. Defaults to False.</p></li>
<li><p><strong>polishing_kwargs_reflectivity</strong> (<em>dict</em>)  extra arguments for the reflectivity function used during polishing.</p></li>
<li><p><strong>fit_growth</strong> (<em>bool</em><em>, </em><em>optional</em>)  If <code class="docutils literal notranslate"><span class="pre">True</span></code>, an additional parameters is introduced during the LMS polishing to account for the change in the thickness of the upper layer during the in-situ measurement of the reflectivity curve (a linear growth is assumed). Defaults to False.</p></li>
<li><p><strong>max_d_change</strong> (<em>float</em>)  The maximum possible change in the thickness of the upper layer during the in-situ measurement, relevant when polish_prediction and fit_growth are True. Defaults to 5.</p></li>
<li><p><strong>use_q_shift</strong>  If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the prediction is performed for a batch of slightly shifted versions of the input curve and the best result is returned, which is meant to mitigate the influence of imperfect sample alignment, as introduced in Greco et al. (only for models with fixed q-discretization). Defaults to False.</p></li>
<li><p><strong>calc_pred_curve</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to calculate the curve corresponding to the predicted parameters. Defaults to True.</p></li>
<li><p><strong>calc_pred_sld_profile</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to calculate the SLD profile corresponding to the predicted parameters. Defaults to False.</p></li>
<li><p><strong>calc_polished_sld_profile</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to calculate the SLD profile corresponding to the polished parameters. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary containing the predictions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.EasyInferenceModel.predict_using_widget">
<span class="sig-name descname"><span class="pre">predict_using_widget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reflectivity_curve</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/inference/inference_model.html#EasyInferenceModel.predict_using_widget"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.EasyInferenceModel.predict_using_widget" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reflectorch.HuggingfaceQueryMatcher">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HuggingfaceQueryMatcher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repo_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'valentinsingularity/reflectivity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'configs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/inference/query_matcher.html#HuggingfaceQueryMatcher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.HuggingfaceQueryMatcher" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Downloads the available configurations files to a temporary directory and provides functionality for filtering those configuration files matching user specified queries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>repo_id</strong> (<em>str</em>)  The Hugging Face repository ID.</p></li>
<li><p><strong>config_dir</strong> (<em>str</em>)  Directory within the repo where YAML files are stored.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reflectorch.HuggingfaceQueryMatcher.get_matching_configs">
<span class="sig-name descname"><span class="pre">get_matching_configs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/inference/query_matcher.html#HuggingfaceQueryMatcher.get_matching_configs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.HuggingfaceQueryMatcher.get_matching_configs" title="Link to this definition">#</a></dt>
<dd><p>retrieves configuration files that match the user specified query.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>query</strong> (<em>dict</em>)  Dictionary of key-value pairs to filter configurations, e.g. <code class="docutils literal notranslate"><span class="pre">query</span> <span class="pre">=</span> <span class="pre">{'dset.prior_sampler.kwargs.max_num_layers':</span> <span class="pre">3,</span> <span class="pre">'dset.prior_sampler.kwargs.param_ranges.slds':</span> <span class="pre">[0.,</span> <span class="pre">100.]}</span></code>.
For keys containing the <code class="docutils literal notranslate"><span class="pre">param_ranges</span></code> subkey a configuration is selected if the value of the query (i.e. desired parameter range)
is a subrange of the parameter range in the configuration, in all other cases the values must match exactly.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of file names that match the query.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.standard_preprocessing">
<span class="sig-name descname"><span class="pre">standard_preprocessing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scattering_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attenuation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_interp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_intensity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'gauss'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'box'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gauss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'first'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'max'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'incoming_intensity'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incoming_intensity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/reflectorch/inference/preprocess_exp/preprocess.html#standard_preprocessing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.standard_preprocessing" title="Link to this definition">#</a></dt>
<dd><p>Preprocesses a raw experimental reflectivity curve by applying attenuation correction, footprint correction, cutting at a maximum q value and interpolation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>intensity</strong> (<em>np.ndarray</em>)  array of intensities of the reflectivity curve</p></li>
<li><p><strong>scattering_angle</strong> (<em>np.ndarray</em>)  array of scattering angles</p></li>
<li><p><strong>attenuation</strong> (<em>np.ndarray</em>)  attenuation factors for each measured point</p></li>
<li><p><strong>q_interp</strong> (<em>np.ndarray</em>)  reciprocal space points used for the interpolation</p></li>
<li><p><strong>wavelength</strong> (<em>float</em>)  the wavelength of the beam</p></li>
<li><p><strong>beam_width</strong> (<em>float</em>)  the beam width</p></li>
<li><p><strong>sample_length</strong> (<em>float</em>)  the sample length</p></li>
<li><p><strong>min_intensity</strong> (<em>float</em><em>, </em><em>optional</em>)  intensities lower than this value are removed. Defaults to 1e-10.</p></li>
<li><p><strong>beam_shape</strong> (<em>BEAM_SHAPE</em><em>, </em><em>optional</em>)  the shape of the beam, either gauss or box. Defaults to gauss.</p></li>
<li><p><strong>normalize_mode</strong> (<em>NORMALIZE_MODE</em><em>, </em><em>optional</em>)  normalization mode, either first, max or incoming_intensity. Defaults to max.</p></li>
<li><p><strong>incoming_intensity</strong> (<em>float</em><em>, </em><em>optional</em>)  array of intensities for the incoming_intensity normalization. Defaults to None.</p></li>
<li><p><strong>max_q</strong> (<em>float</em><em>, </em><em>optional</em>)  the maximum q value at which the curve is cut. Defaults to None.</p></li>
<li><p><strong>max_angle</strong> (<em>float</em><em>, </em><em>optional</em>)  the maximum scattering angle at which the curve is cut; only used if max_q is not provided. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary containing the interpolated reflectivity curve, the curve before interpolation, the q values before interpolation, the q values after interpolation and the q ratio of the cutting</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.interp_reflectivity">
<span class="sig-name descname"><span class="pre">interp_reflectivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_interp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reflectivity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reflectorch/inference/preprocess_exp/interpolation.html#interp_reflectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.interp_reflectivity" title="Link to this definition">#</a></dt>
<dd><p>Interpolate data on a base 10 logarithmic scale</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_interp</strong> (<em>array-like</em>)  reciprocal space points used for the interpolation</p></li>
<li><p><strong>q</strong> (<em>array-like</em>)  reciprocal space points of the measured reflectivity curve</p></li>
<li><p><strong>reflectivity</strong> (<em>array-like</em>)  reflectivity curve measured at the points <code class="docutils literal notranslate"><span class="pre">q</span></code></p></li>
<li><p><strong>min_value</strong> (<em>float</em><em>, </em><em>optional</em>)  minimum intensity of the reflectivity curve. Defaults to 1e-10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>interpolated reflectivity curve</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.apply_attenuation_correction">
<span class="sig-name descname"><span class="pre">apply_attenuation_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attenuation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scattering_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_discontinuities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/reflectorch/inference/preprocess_exp/attenuation.html#apply_attenuation_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.apply_attenuation_correction" title="Link to this definition">#</a></dt>
<dd><p>Applies attenuation correction to experimental reflectivity curves</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>intensity</strong> (<em>np.ndarray</em>)  intensities of an experimental reflectivity curve</p></li>
<li><p><strong>attenuation</strong> (<em>np.ndarray</em>)  attenuation factors for each measured point</p></li>
<li><p><strong>scattering_angle</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>)  scattering angles of the measured points. Defaults to None.</p></li>
<li><p><strong>correct_discontinuities</strong> (<em>bool</em><em>, </em><em>optional</em>)  whether to correct discontinuities in the measured curves. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the corrected reflectivity curve</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reflectorch.apply_footprint_correction">
<span class="sig-name descname"><span class="pre">apply_footprint_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scattering_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'gauss'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'box'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gauss'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/reflectorch/inference/preprocess_exp/footprint.html#apply_footprint_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reflectorch.apply_footprint_correction" title="Link to this definition">#</a></dt>
<dd><p>Applies footprint correction to an experimental reflectivity curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>intensity</strong> (<em>np.ndarray</em>)  reflectivity curve</p></li>
<li><p><strong>scattering_angle</strong> (<em>np.ndarray</em>)  array of scattering angles</p></li>
<li><p><strong>beam_width</strong> (<em>float</em>)  the beam width</p></li>
<li><p><strong>sample_length</strong> (<em>float</em>)  the sample length</p></li>
<li><p><strong>beam_shape</strong> (<em>BEAM_SHAPE</em><em>, </em><em>optional</em>)  the shape of the beam, either gauss or box. Defaults to gauss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the footprint corrected reflectivity curve</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "schreiber-lab/reflectorch",
            ref: "dev_vm",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="advanced_functionality.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Advanced functionality</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params"><code class="docutils literal notranslate"><span class="pre">Params</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.reflectivity"><code class="docutils literal notranslate"><span class="pre">Params.reflectivity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.scale_with_q"><code class="docutils literal notranslate"><span class="pre">Params.scale_with_q()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.d_rhos"><code class="docutils literal notranslate"><span class="pre">Params.d_rhos</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.as_tensor"><code class="docutils literal notranslate"><span class="pre">Params.as_tensor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.from_tensor"><code class="docutils literal notranslate"><span class="pre">Params.from_tensor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.size2layers_num"><code class="docutils literal notranslate"><span class="pre">Params.size2layers_num()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.layers_num2size"><code class="docutils literal notranslate"><span class="pre">Params.layers_num2size()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Params.get_param_labels"><code class="docutils literal notranslate"><span class="pre">Params.get_param_labels()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler"><code class="docutils literal notranslate"><span class="pre">PriorSampler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler.PARAM_CLS"><code class="docutils literal notranslate"><span class="pre">PriorSampler.PARAM_CLS</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler.param_dim"><code class="docutils literal notranslate"><span class="pre">PriorSampler.param_dim</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler.max_num_layers"><code class="docutils literal notranslate"><span class="pre">PriorSampler.max_num_layers</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler.sample"><code class="docutils literal notranslate"><span class="pre">PriorSampler.sample()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler.scale_params"><code class="docutils literal notranslate"><span class="pre">PriorSampler.scale_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PriorSampler.restore_params"><code class="docutils literal notranslate"><span class="pre">PriorSampler.restore_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicDataset"><code class="docutils literal notranslate"><span class="pre">BasicDataset</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicDataset.update_batch_data"><code class="docutils literal notranslate"><span class="pre">BasicDataset.update_batch_data()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicDataset.get_batch"><code class="docutils literal notranslate"><span class="pre">BasicDataset.get_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.QGenerator"><code class="docutils literal notranslate"><span class="pre">QGenerator</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstantQ"><code class="docutils literal notranslate"><span class="pre">ConstantQ</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstantQ.get_batch"><code class="docutils literal notranslate"><span class="pre">ConstantQ.get_batch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstantQ.scale_q"><code class="docutils literal notranslate"><span class="pre">ConstantQ.scale_q()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.VariableQ"><code class="docutils literal notranslate"><span class="pre">VariableQ</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.VariableQ.get_batch"><code class="docutils literal notranslate"><span class="pre">VariableQ.get_batch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.VariableQ.scale_q"><code class="docutils literal notranslate"><span class="pre">VariableQ.scale_q()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.QNoiseGenerator"><code class="docutils literal notranslate"><span class="pre">QNoiseGenerator</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.IntensityNoiseGenerator"><code class="docutils literal notranslate"><span class="pre">IntensityNoiseGenerator</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CurvesScaler"><code class="docutils literal notranslate"><span class="pre">CurvesScaler</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogAffineCurvesScaler"><code class="docutils literal notranslate"><span class="pre">LogAffineCurvesScaler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogAffineCurvesScaler.scale"><code class="docutils literal notranslate"><span class="pre">LogAffineCurvesScaler.scale()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogAffineCurvesScaler.restore"><code class="docutils literal notranslate"><span class="pre">LogAffineCurvesScaler.restore()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.MeanNormalizationCurvesScaler"><code class="docutils literal notranslate"><span class="pre">MeanNormalizationCurvesScaler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.MeanNormalizationCurvesScaler.scale"><code class="docutils literal notranslate"><span class="pre">MeanNormalizationCurvesScaler.scale()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.MeanNormalizationCurvesScaler.restore"><code class="docutils literal notranslate"><span class="pre">MeanNormalizationCurvesScaler.restore()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.MeanNormalizationCurvesScaler.save"><code class="docutils literal notranslate"><span class="pre">MeanNormalizationCurvesScaler.save()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.get_density_profiles"><code class="docutils literal notranslate"><span class="pre">get_density_profiles()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.reflectivity"><code class="docutils literal notranslate"><span class="pre">reflectivity()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Smearing"><code class="docutils literal notranslate"><span class="pre">Smearing</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Smearing.scale_resolutions"><code class="docutils literal notranslate"><span class="pre">Smearing.scale_resolutions()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogLikelihood"><code class="docutils literal notranslate"><span class="pre">LogLikelihood</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogLikelihood.calc_log_likelihood"><code class="docutils literal notranslate"><span class="pre">LogLikelihood.calc_log_likelihood()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogLikelihood.calc_log_posterior"><code class="docutils literal notranslate"><span class="pre">LogLikelihood.calc_log_posterior()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.GaussianExpIntensityNoise"><code class="docutils literal notranslate"><span class="pre">GaussianExpIntensityNoise</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.GaussianExpIntensityNoise.apply"><code class="docutils literal notranslate"><span class="pre">GaussianExpIntensityNoise.apply()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicQNoiseGenerator"><code class="docutils literal notranslate"><span class="pre">BasicQNoiseGenerator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicQNoiseGenerator.apply"><code class="docutils literal notranslate"><span class="pre">BasicQNoiseGenerator.apply()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstantAngle"><code class="docutils literal notranslate"><span class="pre">ConstantAngle</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstantAngle.get_batch"><code class="docutils literal notranslate"><span class="pre">ConstantAngle.get_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler.PARAM_CLS"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler.PARAM_CLS</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler.max_num_layers"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler.max_num_layers</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler.param_dim"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler.param_dim</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler.sample"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler.sample()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler.scale_params"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler.scale_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SubpriorParametricSampler.restore_params"><code class="docutils literal notranslate"><span class="pre">SubpriorParametricSampler.restore_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams"><code class="docutils literal notranslate"><span class="pre">BasicParams</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.get_param_labels"><code class="docutils literal notranslate"><span class="pre">BasicParams.get_param_labels()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.reflectivity"><code class="docutils literal notranslate"><span class="pre">BasicParams.reflectivity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.max_layer_num"><code class="docutils literal notranslate"><span class="pre">BasicParams.max_layer_num</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.num_params"><code class="docutils literal notranslate"><span class="pre">BasicParams.num_params</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.thicknesses"><code class="docutils literal notranslate"><span class="pre">BasicParams.thicknesses</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.roughnesses"><code class="docutils literal notranslate"><span class="pre">BasicParams.roughnesses</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.slds"><code class="docutils literal notranslate"><span class="pre">BasicParams.slds</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.real_slds"><code class="docutils literal notranslate"><span class="pre">BasicParams.real_slds</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.imag_slds"><code class="docutils literal notranslate"><span class="pre">BasicParams.imag_slds</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.as_tensor"><code class="docutils literal notranslate"><span class="pre">BasicParams.as_tensor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.from_tensor"><code class="docutils literal notranslate"><span class="pre">BasicParams.from_tensor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicParams.scale_with_q"><code class="docutils literal notranslate"><span class="pre">BasicParams.scale_with_q()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel"><code class="docutils literal notranslate"><span class="pre">ParametricModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel.param_dim"><code class="docutils literal notranslate"><span class="pre">ParametricModel.param_dim</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel.sampler_strategy"><code class="docutils literal notranslate"><span class="pre">ParametricModel.sampler_strategy</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel.reflectivity"><code class="docutils literal notranslate"><span class="pre">ParametricModel.reflectivity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel.init_bounds"><code class="docutils literal notranslate"><span class="pre">ParametricModel.init_bounds()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel.get_param_labels"><code class="docutils literal notranslate"><span class="pre">ParametricModel.get_param_labels()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ParametricModel.sample"><code class="docutils literal notranslate"><span class="pre">ParametricModel.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SamplerStrategy"><code class="docutils literal notranslate"><span class="pre">SamplerStrategy</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicSamplerStrategy"><code class="docutils literal notranslate"><span class="pre">BasicSamplerStrategy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.BasicSamplerStrategy.sample"><code class="docutils literal notranslate"><span class="pre">BasicSamplerStrategy.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstrainedRoughnessSamplerStrategy"><code class="docutils literal notranslate"><span class="pre">ConstrainedRoughnessSamplerStrategy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstrainedRoughnessSamplerStrategy.sample"><code class="docutils literal notranslate"><span class="pre">ConstrainedRoughnessSamplerStrategy.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstrainedRoughnessAndImgSldSamplerStrategy"><code class="docutils literal notranslate"><span class="pre">ConstrainedRoughnessAndImgSldSamplerStrategy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConstrainedRoughnessAndImgSldSamplerStrategy.sample"><code class="docutils literal notranslate"><span class="pre">ConstrainedRoughnessAndImgSldSamplerStrategy.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Trainer"><code class="docutils literal notranslate"><span class="pre">Trainer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Trainer.log"><code class="docutils literal notranslate"><span class="pre">Trainer.log()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Trainer.train"><code class="docutils literal notranslate"><span class="pre">Trainer.train()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Trainer.configure_optimizer"><code class="docutils literal notranslate"><span class="pre">Trainer.configure_optimizer()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Trainer.lr"><code class="docutils literal notranslate"><span class="pre">Trainer.lr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Trainer.set_lr"><code class="docutils literal notranslate"><span class="pre">Trainer.set_lr()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.TrainerCallback"><code class="docutils literal notranslate"><span class="pre">TrainerCallback</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.TrainerCallback.start_training"><code class="docutils literal notranslate"><span class="pre">TrainerCallback.start_training()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.TrainerCallback.end_training"><code class="docutils literal notranslate"><span class="pre">TrainerCallback.end_training()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.TrainerCallback.end_batch"><code class="docutils literal notranslate"><span class="pre">TrainerCallback.end_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PeriodicTrainerCallback"><code class="docutils literal notranslate"><span class="pre">PeriodicTrainerCallback</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PeriodicTrainerCallback.end_batch"><code class="docutils literal notranslate"><span class="pre">PeriodicTrainerCallback.end_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SaveBestModel"><code class="docutils literal notranslate"><span class="pre">SaveBestModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SaveBestModel.end_batch"><code class="docutils literal notranslate"><span class="pre">SaveBestModel.end_batch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.SaveBestModel.save"><code class="docutils literal notranslate"><span class="pre">SaveBestModel.save()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogLosses"><code class="docutils literal notranslate"><span class="pre">LogLosses</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogLosses.end_batch"><code class="docutils literal notranslate"><span class="pre">LogLosses.end_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Logger"><code class="docutils literal notranslate"><span class="pre">Logger</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.Loggers"><code class="docutils literal notranslate"><span class="pre">Loggers</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PrintLogger"><code class="docutils literal notranslate"><span class="pre">PrintLogger</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.TensorBoardLogger"><code class="docutils literal notranslate"><span class="pre">TensorBoardLogger</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.TensorBoardLogger.log"><code class="docutils literal notranslate"><span class="pre">TensorBoardLogger.log()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ScheduleBatchSize"><code class="docutils literal notranslate"><span class="pre">ScheduleBatchSize</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ScheduleLR"><code class="docutils literal notranslate"><span class="pre">ScheduleLR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ScheduleLR.start_training"><code class="docutils literal notranslate"><span class="pre">ScheduleLR.start_training()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ScheduleLR.end_batch"><code class="docutils literal notranslate"><span class="pre">ScheduleLR.end_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.StepLR"><code class="docutils literal notranslate"><span class="pre">StepLR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.StepLR.start_training"><code class="docutils literal notranslate"><span class="pre">StepLR.start_training()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CyclicLR"><code class="docutils literal notranslate"><span class="pre">CyclicLR</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogCyclicLR"><code class="docutils literal notranslate"><span class="pre">LogCyclicLR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.LogCyclicLR.end_batch"><code class="docutils literal notranslate"><span class="pre">LogCyclicLR.end_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ReduceLROnPlateau"><code class="docutils literal notranslate"><span class="pre">ReduceLROnPlateau</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ReduceLROnPlateau.end_batch"><code class="docutils literal notranslate"><span class="pre">ReduceLROnPlateau.end_batch()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.OneCycleLR"><code class="docutils literal notranslate"><span class="pre">OneCycleLR</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CosineAnnealingWithWarmup"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingWithWarmup</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CosineAnnealingWithWarmup.get_lr"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingWithWarmup.get_lr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CosineAnnealingWithWarmup.start_training"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingWithWarmup.start_training()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CosineAnnealingWithWarmup.end_batch"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingWithWarmup.end_batch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.CosineAnnealingWithWarmup.simulate_and_plot"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingWithWarmup.simulate_and_plot()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ReflectivityDataLoader"><code class="docutils literal notranslate"><span class="pre">ReflectivityDataLoader</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.RealTimeSimTrainer"><code class="docutils literal notranslate"><span class="pre">RealTimeSimTrainer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.RealTimeSimTrainer.get_batch_by_idx"><code class="docutils literal notranslate"><span class="pre">RealTimeSimTrainer.get_batch_by_idx()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.RealTimeSimTrainer.get_batch_by_size"><code class="docutils literal notranslate"><span class="pre">RealTimeSimTrainer.get_batch_by_size()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PointEstimatorTrainer"><code class="docutils literal notranslate"><span class="pre">PointEstimatorTrainer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.PointEstimatorTrainer.get_loss_dict"><code class="docutils literal notranslate"><span class="pre">PointEstimatorTrainer.get_loss_dict()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConvEncoder"><code class="docutils literal notranslate"><span class="pre">ConvEncoder</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.ConvEncoder.forward"><code class="docutils literal notranslate"><span class="pre">ConvEncoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.FnoEncoder"><code class="docutils literal notranslate"><span class="pre">FnoEncoder</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.NetworkWithPriors"><code class="docutils literal notranslate"><span class="pre">NetworkWithPriors</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.NetworkWithPriors.forward"><code class="docutils literal notranslate"><span class="pre">NetworkWithPriors.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.NetworkWithPriorsConvEmb"><code class="docutils literal notranslate"><span class="pre">NetworkWithPriorsConvEmb</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.NetworkWithPriorsFnoEmb"><code class="docutils literal notranslate"><span class="pre">NetworkWithPriorsFnoEmb</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.to_np"><code class="docutils literal notranslate"><span class="pre">to_np()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.to_t"><code class="docutils literal notranslate"><span class="pre">to_t()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.train_from_config"><code class="docutils literal notranslate"><span class="pre">train_from_config()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.get_trainer_from_config"><code class="docutils literal notranslate"><span class="pre">get_trainer_from_config()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.get_paths_from_config"><code class="docutils literal notranslate"><span class="pre">get_paths_from_config()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.get_callbacks_from_config"><code class="docutils literal notranslate"><span class="pre">get_callbacks_from_config()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.get_trainer_by_name"><code class="docutils literal notranslate"><span class="pre">get_trainer_by_name()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.convert_pt_to_safetensors"><code class="docutils literal notranslate"><span class="pre">convert_pt_to_safetensors()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.load_config"><code class="docutils literal notranslate"><span class="pre">load_config()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.EasyInferenceModel"><code class="docutils literal notranslate"><span class="pre">EasyInferenceModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.EasyInferenceModel.load_model"><code class="docutils literal notranslate"><span class="pre">EasyInferenceModel.load_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.EasyInferenceModel.predict"><code class="docutils literal notranslate"><span class="pre">EasyInferenceModel.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.EasyInferenceModel.predict_using_widget"><code class="docutils literal notranslate"><span class="pre">EasyInferenceModel.predict_using_widget()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.HuggingfaceQueryMatcher"><code class="docutils literal notranslate"><span class="pre">HuggingfaceQueryMatcher</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.HuggingfaceQueryMatcher.get_matching_configs"><code class="docutils literal notranslate"><span class="pre">HuggingfaceQueryMatcher.get_matching_configs()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.standard_preprocessing"><code class="docutils literal notranslate"><span class="pre">standard_preprocessing()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.interp_reflectivity"><code class="docutils literal notranslate"><span class="pre">interp_reflectivity()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.apply_attenuation_correction"><code class="docutils literal notranslate"><span class="pre">apply_attenuation_correction()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflectorch.apply_footprint_correction"><code class="docutils literal notranslate"><span class="pre">apply_footprint_correction()</span></code></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Schreiber Lab
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>